webpackJsonp([1],{"0+/0":function(t,e){},"13nz":function(t,e){},"1fAO":function(t,e){},"1jb5":function(t,e){},"2fBO":function(t,e){},"4Wh8":function(t,e){},"4k5+":function(t,e){},"5LD2":function(t,e){},"5PgG":function(t,e){},"8AoJ":function(t,e){},"8C6H":function(t,e){},"9PLK":function(t,e){},BGZ6:function(t,e){},FA9q:function(t,e){},HmYq:function(t,e){},I78t:function(t,e){},KhCJ:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),i=n("Dd8w"),s=n.n(i),r=n("NYxO"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"KedjaLogo"},[e("router-link",{attrs:{to:{name:"Home",params:{}}}},[this._v("\n    KEDJA.\n  ")])],1)},staticRenderFns:[]};var c=n("VU/8")({name:"KedjaLogo",data:function(){return{}},props:{},computed:{},methods:{},mounted:function(){}},o,!1,function(t){n("v0MC")},"data-v-3b28c041",null).exports,l={name:"DropDown",data:function(){return{open:!1}},props:{items:Array},methods:{toggleList:function(){this.open=!this.open},close:function(){this.open=!1},blur:function(t){this.$el.contains(t.relatedTarget)||this.close()},performFunction:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t&&t(e),this.close()}}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"DropDown",attrs:{tabindex:"0"},on:{blur:function(e){return t.blur(e)}}},[n("div",{staticClass:"toggle",on:{click:t.toggleList}},[t._t("default")],2),t._v(" "),n("div",{staticClass:"listContainer z2",attrs:{tabindex:"0"}},[n("div",{staticClass:"list",class:{open:t.open},attrs:{tabindex:"0"}},t._l(t.items,function(e,a){return n("div",{key:a,staticClass:"listItem",attrs:{tabindex:"0"},on:{click:function(n){return t.performFunction(e.f,e.args)}}},[t._v("\n        "+t._s(e.label)+"\n      ")])}),0)])])},staticRenderFns:[]};var u=n("VU/8")(l,d,!1,function(t){n("1jb5")},"data-v-f022d07e",null).exports,f={name:"UserButton",props:{user:Object,color:String,small:Boolean,noClick:Boolean},computed:{style:function(){return this.color&&"background-color: "+this.color+";"},classes:function(){return{small:this.small,"no-click":this.noClick}}},methods:{click:function(t){this.noClick?t.currentTarget.blur():this.$emit("click",t)}}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"user-button",class:this.classes,style:this.style,on:{click:this.click}},[e("img",{attrs:{src:this.user.data.picture,title:this.user.data.fullName,height:"100%",width:"100%"}})])},staticRenderFns:[]};var m=n("VU/8")(f,h,!1,function(t){n("RWOq")},null,null).exports,v=n("//Fk"),p=n.n(v),g=n("mtWM"),C=n.n(g),_=["#85B96D","#27CBFF","#517480","#FF2741","#00D6A2"];function b(t){return _[t%_.length]}var w=new a.a,k=C.a.create({baseURL:"https://staging-server.kedja.org/api/1/",headers:{Authorization:localStorage.auth}});function x(t){w.$emit("dialogOpen",t)}function $(t){x({title:"",message:t.message,buttons:[{text:"Radera",classes:"btn-warning",action:t.action},{text:"Avbryt",classes:"btn-primary"}]})}k.interceptors.response.use(function(t){return t},function(t){return x(),p.a.reject(t)});var U={name:"KedjaHeader",components:{KedjaLogo:c,DropDown:u,UserButton:m},computed:s()({},Object(r.c)(["isAuthenticated"]),Object(r.c)("users",["currentUser"]),Object(r.e)(["userState"])),methods:{goToProfile:function(){"Profile"!==this.$route.name&&this.$router.push({name:"Profile"})},goToWalls:function(){"Walls"!==this.$route.name&&this.$router.push({name:"Walls"})},logout:function(){var t=this;k.post("auth/logout").then(function(e){t.$store.dispatch("logout"),t.$router.push({name:"Login"})})}}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"KedjaHeader"},[n("kedja-logo"),t._v(" "),n("div",{staticClass:"slot"},[t._t("default")],2),t._v(" "),n("div",{staticClass:"user"},[t.isAuthenticated?n("div",[n("drop-down",{attrs:{items:[{label:"Min profil",f:t.goToProfile},{label:"Mina väggar",f:t.goToWalls},{label:"Logga ut",f:t.logout}]}},[n("div",{staticClass:"right"},[n("user-button",{attrs:{user:t.currentUser}})],1)])],1):t._e()])],1)},staticRenderFns:[]};var y=n("VU/8")(U,E,!1,function(t){n("tFfL")},"data-v-de088002",null).exports,S={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"KedjaHeader"})},staticRenderFns:[]};var O=n("VU/8")({name:"KedjaHeader",data:function(){return{}},props:{},computed:{},methods:{},mounted:function(){}},S,!1,function(t){n("13nz")},"data-v-29106db2",null).exports,I={name:"Modal",data:function(){return{isActive:!1,isOpen:!1,dismissable:!0,component:null,data:null,headline:null}},computed:{classes:function(){return{active:this.isActive,open:this.isOpen}}},methods:{open:function(t){var e=this;t&&(this.dismissable=t.dismissable||!0,this.component=t.component||null,this.data=t.data||null,this.headline=t.headline||null),this.isActive=!0,this.$nextTick(function(){e.isOpen=!0})},close:function(){this.isOpen=!1,this.isActive=!1},dismiss:function(){this.dismissable&&this.close()}},created:function(){var t=this;w.$on("modalOpen",this.open),w.$on("modalClose",this.close),document.addEventListener("keyup",function(e){t.open&&"Escape"===e.key&&t.dismiss()})}},W={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.classes,attrs:{id:"modal-backdrop"},on:{click:function(e){return e.target!==e.currentTarget?null:t.dismiss(e)}}},[n("div",{staticClass:"modal-window",attrs:{role:"modal"}},[n("button",{directives:[{name:"show",rawName:"v-show",value:t.dismissable,expression:"dismissable"}],staticClass:"closer",on:{click:t.close}},[t._v("×")]),t._v(" "),t.headline?n("h1",[t._v(t._s(t.headline))]):t._e(),t._v(" "),t.component?n(t.component,{tag:"component",attrs:{data:t.data}}):t._e()],1)])},staticRenderFns:[]};var j=n("VU/8")(I,W,!1,function(t){n("8AoJ")},null,null).exports,L=n("woOf"),D=n.n(L),R={buttons:[{text:"OK",classes:"btn-primary"}],title:"Något gick fel",message:"Okänt fel. Kontrollera din nätverksuppkoppling.",dismissable:!0},A={name:"Dialog",data:function(){return{isActive:!1,isOpen:!1,params:{}}},computed:{classes:function(){return{active:this.isActive,open:this.isOpen}},dismissable:function(){return this.params.dismissable}},methods:{buttonClick:function(t){t.action&&t.action(),this.close()},open:function(t){var e=this;this.params={},D()(this.params,R),D()(this.params,t),this.isActive=!0,this.$nextTick(function(){e.isOpen=!0})},close:function(){this.isOpen=!1,this.isActive=!1},dismiss:function(){this.dismissable&&this.close()}},created:function(){var t=this;w.$on("dialogOpen",this.open),document.addEventListener("keyup",function(e){t.open&&"Escape"===e.key&&t.dismiss()})}},F={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.classes,attrs:{id:"dialog-backdrop"},on:{click:function(e){return e.target!==e.currentTarget?null:t.dismiss(e)}}},[n("div",{staticClass:"dialog-window",attrs:{role:"dialog"}},[t.params.title?n("h2",[t._v(t._s(t.params.title))]):t._e(),t._v(" "),n("span",{staticClass:"message"},[t._v(t._s(t.params.message))]),t._v(" "),n("div",{staticClass:"buttons"},t._l(t.params.buttons,function(e,a){return n("button",{key:a,class:e.classes,on:{click:function(n){return t.buttonClick(e)}}},[t._v(t._s(e.text))])}),0)])])},staticRenderFns:[]};var V={name:"App",components:{KedjaHeader:y,KedjaFooter:O,Modal:j,Dialogz:n("VU/8")(A,F,!1,function(t){n("OtJe")},null,null).exports},created:function(){this.loadUserFromLocalStorage(),this.authenticate(),this.resetUserState()},mounted:function(){document.activeElement.blur()},methods:s()({},Object(r.b)(["authenticate"]),Object(r.d)(["resetUserState"]),Object(r.d)("users",["loadUserFromLocalStorage"]))},N={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view",{attrs:{id:"router"}}),this._v(" "),e("kedja-footer",{attrs:{id:"footer"}}),this._v(" "),e("modal"),this._v(" "),e("dialogz")],1)},staticRenderFns:[]};var B=n("VU/8")(V,N,!1,function(t){n("x5WV")},null,null).exports,T=n("/ocq"),P={name:"ViewHome",components:{KedjaHeader:y},computed:s()({},Object(r.c)(["isAuthenticated"])),methods:{loggedIn:function(){this.isAuthenticated?this.$router.push({name:"Walls"}):this.$router.push({name:"Login"})}},created:function(){this.loggedIn()}},K={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ViewHome"},[e("kedja-header"),this._v(" "),e("div",{staticClass:"viewContent"},[this._v("\n    HEM\n  ")])],1)},staticRenderFns:[]};var H=n("VU/8")(P,K,!1,function(t){n("S2Bu")},"data-v-59b441b6",null).exports,M={name:"ViewLogin",components:{KedjaHeader:y},data:function(){return{email:"",pass:"",methods:""}},props:{},computed:s()({},Object(r.c)(["isAuthenticated"])),methods:{loginUrl:function(t){return t.url+"?came_from="+window.location.origin},getLoginMethods:function(){var t=this;k.get("auth/methods").then(function(e){t.methods=e.data})},loggedIn:function(){this.isAuthenticated&&this.$router.push({name:"Home"})}},created:function(){this.loggedIn()},mounted:function(){this.getLoginMethods()}},J={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewLogin"},[n("kedja-header"),t._v(" "),n("div",{staticClass:"viewContent"},[n("h1",[t._v("\n      KEDJA.\n    ")]),t._v(" "),n("h3",[t._v("Logga in / Registrera nytt konto med")]),t._v(" "),t._l(t.methods,function(e,a){return n("h2",{key:a},[n("a",{attrs:{href:t.loginUrl(e)}},[t._v(t._s(e.title))])])})],2)],1)},staticRenderFns:[]};var q=n("VU/8")(M,J,!1,function(t){n("I78t")},"data-v-b42a63f8",null).exports,z={name:"ViewLoggingIn",components:{KedjaHeader:y},data:function(){return{}},props:{},computed:{auth:function(){return this.$store.getters.getAuth},userid:function(){return this.$route.query.u},token:function(){return this.$route.query.t}},methods:{login:function(){var t=this;k.post("auth/credentials/"+this.userid+"/"+this.token).then(function(e){console.log(e),t.$store.dispatch("login",e.data),t.$router.push({name:"Home"})})}},created:function(){},mounted:function(){this.login()}},G={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ViewLoggingIn"},[e("kedja-header"),this._v(" "),e("div",{staticClass:"viewContent"},[this._v("\n    Du loggas in.\n  ")])],1)},staticRenderFns:[]};var Y=n("VU/8")(z,G,!1,function(t){n("4k5+")},"data-v-2b912576",null).exports,Z={name:"ViewRegister",components:{KedjaHeader:y},computed:{registerToken:function(){return this.$route.query.t}},methods:{register:function(){var t=this;k.post("auth/register/"+this.registerToken).then(function(e){console.log(e),t.$store.dispatch("login",e.data),t.$router.push({name:"Home"})})}}},X={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewRegister"},[n("kedja-header"),t._v(" "),n("div",{staticClass:"viewContent"},[n("h2",[t._v("Registrera nytt konto")]),t._v(" "),n("p",[t._v("\n      Du behöver registrera ett konto på Kedja för att fortsätta inloggningen.\n    ")]),t._v(" "),t._m(0),t._v(" "),n("form",{on:{submit:function(e){return e.preventDefault(),t.register(e)}}},[t._m(1),t._v(" "),n("button",{attrs:{type:"submit"}},[t._v("Sälj min själ")])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("a",{attrs:{href:""}},[this._v("Läs användaravtal")]),this._v(" för registrering och användning av Kedja.\n    ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",[e("input",{attrs:{type:"checkbox"}}),this._v(" Jag går med på allt.\n      ")])}]};var Q=n("VU/8")(Z,X,!1,function(t){n("2fBO")},"data-v-58208dc2",null).exports,tt={name:"ViewProfile",components:{KedjaHeader:y},data:function(){return{userDataEditable:{}}},props:{},computed:s()({},Object(r.c)("users",["currentUser"]),Object(r.e)("users",["currentUserId"])),methods:s()({},Object(r.d)("users",["setUserData"]),Object(r.b)("users",["fetchUserData"]),{setDataEditable:function(t){this.userDataEditable={first_name:t.first_name,last_name:t.last_name}},updateProfile:function(){var t=this;k.put("users/"+this.currentUserId,this.userDataEditable).then(function(e){t.setUserData(e.data),t.setDataEditable(e.data.data)})}}),created:function(){this.setDataEditable(this.currentUser.data)},mounted:function(){}},et={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewProfile"},[n("kedja-header"),t._v(" "),n("div",{staticClass:"viewContent"},[t._v("\n    Du är inloggad som\n\n    "),n("h2",[t._v("\n      "+t._s(t.currentUser.data.fullName)+"\n    ")]),t._v(" "),n("h3",[t._v("Uppdatera profil")]),t._v(" "),n("form",{on:{submit:function(e){return e.preventDefault(),t.updateProfile(e)}}},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.userDataEditable.first_name,expression:"userDataEditable.first_name"}],attrs:{type:"text",placeholder:"Förnamn"},domProps:{value:t.userDataEditable.first_name},on:{input:function(e){e.target.composing||t.$set(t.userDataEditable,"first_name",e.target.value)}}})]),t._v(" "),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.userDataEditable.last_name,expression:"userDataEditable.last_name"}],attrs:{type:"text",placeholder:"Efternamn"},domProps:{value:t.userDataEditable.last_name},on:{input:function(e){e.target.composing||t.$set(t.userDataEditable,"last_name",e.target.value)}}})]),t._v(" "),n("button",{attrs:{type:"submit"}},[t._v("Spara ändringar")])])])],1)},staticRenderFns:[]};var nt=n("VU/8")(tt,et,!1,function(t){n("m/Pj")},"data-v-5f883589",null).exports,at={name:"RouterLinkBox",props:{text:String,color:String,to:Object}},it={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"RouterLinkBox",style:{"background-color":this.color}},[e("router-link",{staticClass:"link",attrs:{to:this.to}},[this._t("default")],2)],1)},staticRenderFns:[]};var st=n("VU/8")(at,it,!1,function(t){n("5PgG")},"data-v-70845ecf",null).exports,rt={name:"NewWall",data:function(){return{templates:[]}},created:function(){var t=this;k.get("templates").then(function(e){t.templates=e.data})},computed:{},methods:s()({},Object(r.d)("walls",["setWall"]),{createWallAndRedirect:function(t){var e=this;(t?k.post("templates/"+t):k.post("walls",{title:"Ny vägg"})).then(function(t){e.setWall(t.data),e.$router.push({name:"ViewWall",params:{wallId:t.data.rid}}),w.$emit("modalClose")})}})},ot={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._m(0),t._v(" "),n("button",{on:{click:function(e){return t.createWallAndRedirect()}}},[t._v("\n      Blank vägg\n    ")]),t._v(" "),n("h2",[t._v("Skapa från mall")]),t._v(" "),n("div",t._l(t.templates,function(e){return n("button",{key:e.id,on:{click:function(n){return t.createWallAndRedirect(e.id)}}},[t._v("\n        "+t._s(e.title)+"\n      ")])}),0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("header",[e("h1",[this._v("Ny vägg")])])}]};var ct=n("VU/8")(rt,ot,!1,function(t){n("ejGu")},null,null).exports,lt={name:"ViewWallList",components:{KedjaHeader:y,RouterLinkBox:st},computed:s()({},Object(r.c)("walls",["all"])),methods:s()({getColor:function(t){return"private_wall"===t.data.acl_name?"lightsteelblue":"#c2c8e6"}},Object(r.b)("walls",["fetchWalls"]),{openNewWallModal:function(){var t,e;t=ct,w.$emit("modalOpen",{component:t,data:e})}}),mounted:function(){this.fetchWalls()}},dt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewWallList"},[n("kedja-header",[n("button",{on:{click:t.openNewWallModal}},[t._v("\n      + Ny vägg\n    ")])]),t._v(" "),n("h3",[t._v("Mina väggar")]),t._v(" "),n("div",{staticClass:"wallBoxes"},t._l(t.all,function(e){return n("router-link-box",{key:e.rid,staticClass:"wallBox",attrs:{to:{name:"ViewWall",params:{wallId:e.rid}},color:t.getColor(e)}},[n("h3",[t._v("\n        "+t._s(e.data.title)+"\n      ")])])}),1)],1)},staticRenderFns:[]};var ut=n("VU/8")(lt,dt,!1,function(t){n("FA9q")},"data-v-7c8065cc",null).exports,ft=n("fZjL"),ht=n.n(ft),mt={name:"WallUserAdmin",components:{UserButton:m},data:function(){return{query:""}},props:{data:Object},computed:s()({wall:function(){return this.data.wall},results:function(){var t=this;return this.query?this.data.users.filter(function(e){return t.query.toLowerCase().split(/\s+/).every(function(t){return e.data.fullName.toLowerCase().includes(t)})}):[]},resultText:function(){return this.results.length?"Visar "+this.results.length+" resultat":"Inga resultat"}},Object(r.c)("users",["currentUser"])),methods:s()({userColor:function(t){return b(t)}},Object(r.d)("walls",["addUser","removeUser"])),mounted:function(){this.$el.querySelector("input").focus()}},vt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"wall-user-modal"}},[n("header",[n("h1",[t._v("Sök användare")]),t._v(" "),n("p",[t._v("Lägg till användare på väggen "),n("em",[t._v(t._s(t.wall.data.title))]),t._v(".")])]),t._v(" "),n("form",{on:{submit:function(t){t.preventDefault()}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],attrs:{type:"search",placeholder:"Sök på namn..."},domProps:{value:t.query},on:{input:function(e){e.target.composing||(t.query=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"results"},[t.query?n("h2",{attrs:{"aria-live":"assertive"}},[t._v(t._s(t.resultText))]):t._e(),t._v(" "),t._l(t.results,function(e,a){return n("div",{key:e.rid,staticClass:"result"},[n("h3",[n("user-button",{attrs:{color:t.userColor(a),user:e,small:"","no-click":""}}),t._v(" "+t._s(e.data.fullName))],1),t._v(" "),t.wall.userList.includes(e.rid)?n("button",{staticClass:"remove-user-button",on:{click:function(n){return t.removeUser({wall:t.wall,user:e})}}},[t._v("- Ta bort användare")]):n("button",{staticClass:"add-user-button",on:{click:function(n){return t.addUser({wall:t.wall,user:e})}}},[t._v("+ Lägg till användare")])])})],2)])},staticRenderFns:[]};var pt=n("VU/8")(mt,vt,!1,function(t){n("oTiU")},null,null).exports,gt={name:"WallUserInfo",props:{data:Object},computed:s()({user:function(){return this.data.user},wall:function(){return this.data.wall},isCurrentUser:function(){return this.user.rid===this.currentUser.rid}},Object(r.c)("users",["currentUser"]))},Ct={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"wall-user-modal"}},[n("header",[n("h1",[t._v(t._s(t.user.data.fullName))]),t._v(" "),t.isCurrentUser?n("p",[t._v("Det är du.")]):n("p",[t._v("Användare på väggen "),n("em",[t._v(t._s(t.wall.data.title))]),t._v(".")])])])},staticRenderFns:[]};var _t=n("VU/8")(gt,Ct,!1,function(t){n("tjhX")},null,null).exports,bt={name:"WidgetIcon",data:function(){return{hovering:!1}},props:{active:Boolean,path:String,img:String,imgHover:String,imgActive:String},computed:{image:function(){var t="";return t=this.active?this.imgActive:this.hovering?this.imgHover:this.img,this.path+t}},methods:{setHovering:function(t){this.hovering=t}},mounted:function(){}},wt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"WidgetIcon",on:{mouseover:function(e){return t.setHovering(!0)},mouseout:function(e){return t.setHovering(!1)}}},[n("img",{attrs:{src:t.image,alt:"Koppla kort"}})])},staticRenderFns:[]};var kt=n("VU/8")(bt,wt,!1,function(t){n("0+/0")},"data-v-19627b26",null).exports,xt={name:"CardFilter",components:{WidgetIcon:kt},computed:s()({},Object(r.e)(["filterCards"])),methods:s()({},Object(r.d)(["setFilterCards"]))},$t={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"CardFilter"},[n("widget-icon",{attrs:{path:"/static/graphics/icons/filter/",img:"KEDJA_Filter off.png",imgHover:"KEDJA_Filter off hover.png",imgActive:"KEDJA_Filter off aktiv.png",active:!t.filterCards,title:"Visa samtliga kort",alt:"Visa samtliga kort"},nativeOn:{click:function(e){return t.setFilterCards(!1)}}}),t._v(" "),n("widget-icon",{attrs:{path:"/static/graphics/icons/filter/",img:"KEDJA_Filter on.png",imgHover:"KEDJA_Filter on hover.png",imgActive:"KEDJA_Filter on aktiv.png",active:t.filterCards,title:"Visa endast kort i vald kedja",alt:"Visa endast kort i vald kedja"},nativeOn:{click:function(e){return t.setFilterCards(!0)}}})],1)},staticRenderFns:[]};var Ut=n("VU/8")(xt,$t,!1,function(t){n("5LD2")},"data-v-a20c2b44",null).exports,Et=n("Gu7T"),yt=n.n(Et),St={name:"WrapperComponent",render:function(t){return t(this.tag,this.$slots.default)},props:{tag:{type:String,required:!0}}},Ot={name:"EditableInput",components:{WrapperComponent:n("VU/8")(St,null,!1,null,null,null).exports},props:{value:String,tag:String,placeholder:{default:"Ange text"},type:{default:"textarea"},focus:Boolean,locked:Boolean},data:function(){return{editing:!1,textTemp:"",width:"",height:"auto"}},computed:{inputVisible:function(){return this.editing||""===this.value}},methods:{openEdit:function(){this.locked||(console.log("Open edit"),this.calcWidth(),this.editing=!0,this.textTemp=this.value,this.$nextTick(function(t){this.$refs.input.focus(),this.$refs.input.select()}))},initEdit:function(){},clearTemp:function(){this.textTemp=""},onInitEdit:function(){this.$emit("init-edit")},cancel:function(){this.editing=!1,this.$emit("cancel")},onBlur:function(){this.editing&&this.finishEdit(!0)},finishEdit:function(t){console.log("Färdigskriven: "+this.editing+" "+t),this.editing&&t&&(this.editing=!1,this.emitToParent())},calcWidth:function(){this.$nextTick(function(){var t=this.$el.getElementsByClassName("textSpan")[0];t&&(this.width=t.offsetWidth+"px",this.height=t.offsetHeight+"px")})},emitToParent:function(){this.$emit("input",this.textTemp),this.$emit("change",this.textTemp)}},mounted:function(){this.focus&&this.openEdit()}},It={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"EditableInput",class:{fullWidth:t.inputVisible,locked:t.locked},on:{click:t.openEdit}},[n("wrapper-component",{staticClass:"text",attrs:{tag:t.tag,id:"eiTemp"}},[t.inputVisible?t._e():n("div",{staticClass:"textContainer",on:{click:function(e){return t.openEdit()}}},[n("span",{staticClass:"textSpan"},[t._v("\n        "+t._s(t.value)+"\n      ")])]),t._v(" "),t.inputVisible?n("div",["input"==t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:t.textTemp,expression:"textTemp"}],ref:"input",style:{height:t.height+"px"},attrs:{placeholder:t.placeholder},domProps:{value:t.textTemp},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancel(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.finishEdit(!0)}],blur:t.onBlur,focus:function(e){return t.onInitEdit()},input:function(e){e.target.composing||(t.textTemp=e.target.value)}}}):t._e(),t._v(" "),"textarea"==t.type?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textTemp,expression:"textTemp"}],ref:"input",style:{width:"100%",height:t.height},attrs:{placeholder:t.placeholder},domProps:{value:t.textTemp},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.finishEdit(!0))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancel(e)}],blur:t.onBlur,focus:function(e){return t.onInitEdit()},change:t.calcWidth,input:function(e){e.target.composing||(t.textTemp=e.target.value)}}}):t._e()]):t._e()])],1)},staticRenderFns:[]};var Wt=n("VU/8")(Ot,It,!1,function(t){n("9PLK")},"data-v-5fa3548c",null).exports,jt={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"CardButton",class:{active:this.active,placeholder:this.placeholder}},[this._t("default")],2)},staticRenderFns:[]};var Lt=n("VU/8")({name:"CardButton",data:function(){return{}},props:{active:!1,placeholder:!1},computed:{},methods:{},mounted:function(){}},jt,!1,function(t){n("1fAO")},"data-v-779fce5c",null).exports,Dt={name:"Indicator",props:{value:Number,min:{default:-1},max:{default:2},selected:Boolean},computed:{image:function(){return"/static/graphics/icons/indicator/KEDJA_Indikator, steg "+(this.value+1)+(this.selected?", markerat":", ej markerat")+" kort.png"}},methods:{onclick:function(t){this.selected&&(t.stopPropagation(),this.increaseValue())},increaseValue:function(){var t=this.value+1;t>this.max&&(t=this.min),this.$emit("change",t),this.$emit("input",t)}}},Rt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Indicator",on:{click:function(e){return t.onclick(e)}}},[n("img",{attrs:{src:t.image,alt:"Indikator"}})])},staticRenderFns:[]};var At={name:"Card",components:{EditableInput:Wt,CardButton:Lt,Indicator:n("VU/8")(Dt,Rt,!1,function(t){n("gmtP")},"data-v-3165727e",null).exports,WidgetIcon:kt,DropDown:u},data:function(){return{initiated:!1}},props:{card:Object,collection:Object},computed:s()({connectionsDirect:function(){return this.getDirectConnectionsByCardId(this.card.rid)},connectionsDeep:function(){return this.getDeepConnectionsByCardId(this.card.rid)},directConnectedCardIds:function(){var t=this,e=[];return this.connectionsDirect.forEach(function(n,a){n.members[0]!==t.card.rid&&-1===e.indexOf(n.members[0])&&e.push(n.members[0]),n.members[1]!==t.card.rid&&-1===e.indexOf(n.members[1])&&e.push(n.members[1])}),e},deepConnectedCardIds:function(){var t=this,e=[];return this.connectionsDeep.forEach(function(n,a){n.members[0]!==t.card.rid&&-1===e.indexOf(n.members[0])&&e.push(n.members[0]),n.members[1]!==t.card.rid&&-1===e.indexOf(n.members[1])&&e.push(n.members[1])}),e},removeVisible:function(){return this.card.states.selected},titleLocked:function(){return"connectCard"===this.userState.name},filtered:function(){return!this.filterCards||"default"===this.userState.name||("selectCard"!==this.userState.name||(this.card.states.selected||this.card.states.selectingConnected))}},Object(r.c)("walls",["getDeepConnectionsByCardId","getDirectConnectionsByCardId","getClosestCardCousins","activeWall"]),Object(r.e)("walls/cards",["cards"]),Object(r.e)(["userState","filterCards"])),watch:{userState:{deep:!0,handler:function(t){(this.resetStates(),"selectCard"===t.name&&(t.data.rid===this.card.rid?this.setState("selected"):-1!==this.deepConnectedCardIds.indexOf(t.data.rid)?this.setState("selectingConnected"):this.setState("selectingNotConnected")),"connectCard"===t.name)&&(t.data.rid===this.card.rid?(this.setState("selected"),this.setState("connecting")):this.directConnectedCardIds.includes(t.data.rid)?this.setState("connectingConnected"):this.getClosestCardCousins(this.card).find(function(e){return e.rid===t.data.rid})?this.setState("connectingNotConnected"):this.setState("connectingCantConnect"))}}},methods:s()({setState:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setCardState({rid:this.card.rid,stateName:t,stateFlag:e})},resetStates:function(){this.resetCardStates({rid:this.card.rid})},resetState:function(t){this.setCardState({rid:this.card.rid,stateName:t})},clicked:function(){"connectCard"!==this.userState.name&&this.setSelected(),this.card.states.connecting&&this.setSelected(),this.card.states.connectingNotConnected?this.connect():this.card.states.connectingConnected&&this.disconnect()},scrollIntoView:function(){},setSelected:function(t){"selectCard"!==this.userState.name||this.userState.data.rid!==this.card.rid?this.setUserState({name:"selectCard",data:{rid:this.card.rid}}):this.resetUserState()},toggleConnecting:function(){this.card.states.connecting?this.setUserState({name:"selectCard",data:{rid:this.card.rid}}):this.setUserState({name:"connectCard",data:{rid:this.card.rid}})},connect:function(){this.resetStates(),this.setState("connectingConnected"),this.createRelation({wall:this.activeWall,cards:[this.card,this.cards[this.userState.data.rid]]})},disconnect:function(){this.resetStates(),this.setState("connectingNotConnected");var t=[this.card,this.cards[this.userState.data.rid]],e=this.activeWall.relations.find(function(e){return e.members[0]===t[0].rid&&e.members[1]===t[1].rid||e.members[0]===t[1].rid&&e.members[1]===t[0].rid});e?this.deleteRelation({wall:this.activeWall,relation:e}):console.log("no relation found for cards",t)},initUpdateTitle:function(){console.log("Börja byt namn på kort"),this.setUserState({name:"renameCard",data:{rid:this.card.rid}})},updateTitle:function(t){k.put("collections/"+this.collection.rid+"/cards/"+this.card.rid,{title:t}).then(function(t){return console.log(t)})},updateIndicatorValue:function(t){var e=this;k.put("collections/"+this.collection.rid+"/cards/"+this.card.rid,{int_indicator:t}).then(function(t){e.setCard(t.data)})},setFocus:function(){this.$el.focus()}},Object(r.b)("walls",["createRelation","deleteRelation"]),Object(r.b)("walls/collections",["removeCard"]),Object(r.d)("walls/cards",["setCardState","resetCardStates","setCard"]),Object(r.d)(["setUserState","resetUserState"]))},Ft={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.filtered?n("div",{staticClass:"Card",class:{selected:t.card.states.selected,selectingConnected:t.card.states.selectingConnected,selectingNotConnected:t.card.states.selectingNotConnected,selectedConnectedOther:0==t.card.states.selectedConnected,connectingConnected:t.card.states.connectingConnected,connectingNotConnected:t.card.states.connectingNotConnected,connectingCantConnect:t.card.states.connectingCantConnect,cannotConnect:!this.card.states.canConnect&&!this.card.states.connecting,connectedOther:0==t.card.states.connected,connecting:this.card.states.connecting},on:{click:function(e){e.stopPropagation(),t.clicked(),t.scrollIntoView()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:e.target!==e.currentTarget?null:t.removeCard(t.card)}}},[n("div",{staticClass:"top"},[n("indicator",{attrs:{selected:t.card.states.selected},on:{change:t.updateIndicatorValue,click:function(t){t.stopPropagation()}},model:{value:t.card.data.int_indicator,callback:function(e){t.$set(t.card.data,"int_indicator",e)},expression:"card.data.int_indicator"}}),t._v(" "),n("card-button",{nativeOn:{click:function(e){e.stopPropagation(),t.toggleConnecting(),t.scrollIntoView()}}},[n("widget-icon",{attrs:{path:"/static/graphics/icons/link/",img:"KEDJA_Koppling.png",imgHover:"KEDJA_Koppling, hover.png",imgActive:"KEDJA_Koppling, igang.png",active:t.card.states.connecting}})],1)],1),t._v(" "),n("div",{staticClass:"main"},[n("EditableInput",{staticClass:"indicator",attrs:{tag:"h3",placeholder:"Namnge kort",locked:t.titleLocked},on:{change:function(e){return t.updateTitle(e)},"init-edit":t.initUpdateTitle,click:function(t){t.stopPropagation()}},model:{value:t.card.data.title,callback:function(e){t.$set(t.card.data,"title",e)},expression:"card.data.title"}})],1),t._v(" "),n("div",{staticClass:"bottom"},[t.removeVisible?n("card-button",{nativeOn:{click:function(e){return e.stopPropagation(),t.removeCard(t.card)}}},[n("widget-icon",{attrs:{path:"/static/graphics/icons/bin/",img:"KEDJA_Papperskorg.png",imgHover:"KEDJA_Papperskorg, hover.png"}})],1):t._e()],1)]):t._e()},staticRenderFns:[]};var Vt=n("VU/8")(At,Ft,!1,function(t){n("y0aV")},"data-v-c7196cc2",null).exports,Nt={name:"CardSeed",components:{EditableInput:Wt},data:function(){return{title:""}},props:{},computed:s()({},Object(r.e)(["userState"])),watch:{},methods:{updateTitle:function(t){this.title="",t?this.$emit("create",t):this.cancel()},cancel:function(){this.$refs.editinput.clearTemp(),this.$emit("cancel")},setFocus:function(){this.$refs.editinput.openEdit()}},created:function(){},mounted:function(){}},Bt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"CardSeed"},[n("div",{staticClass:"main"},[n("EditableInput",{ref:"editinput",attrs:{tag:"h3",placeholder:"Namnge kort"},on:{change:function(e){return t.updateTitle(e)},cancel:t.cancel},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)])},staticRenderFns:[]};var Tt={name:"Collection",components:{DropDown:u,Card:Vt,CardSeed:n("VU/8")(Nt,Bt,!1,function(t){n("4Wh8")},"data-v-3dcd1db8",null).exports,EditableInput:Wt,CardButton:Lt,WidgetIcon:kt},data:function(){var t=this;return{hovering:!1,showCardSeed:!1,dndOptions:{showDropzoneAreas:!0,multipleDropzonesItemsDraggingEnabled:!1,onDragstart:function(e){t.dndPrevented&&e.stop()}}}},computed:s()({cards:function(){return this.getList(this.collection.cardList)},dndPrevented:function(){return this.filterCards&&this.userState.data.rid},cardsFiltered:function(){return"default"===this.userState.name?this.cards:(this.userState.name,this.cards)},newDisabled:function(){return"connectCard"===this.userState.name}},Object(r.c)("walls/cards",["getList","getCardsByState"]),Object(r.e)(["userState","filterCards"])),props:{collection:Object,wall:Object},watch:{userState:function(t){var e=this;"selectCard"===t.name&&this.$nextTick(function(){var t=e.$el.getElementsByClassName("selected");0===t.length&&(t=e.$el.getElementsByClassName("selectingConnected")),t.length>0&&e.$refs.collectionContent.scrollTo({top:t[0].offsetTop-10,behavior:"smooth"})})}},methods:s()({reordered:function(t){if(!this.dndPrevented){var e=Number(t.detail.ids[0]),n=[].concat(yt()(this.collection.cardList)),a=n.indexOf(e),i=Math.min(t.detail.index,n.length-1);i!==a&&(n.splice(a,1),n.splice(i,0,e),this.setCardOrder({collection:this.collection,order:n}))}},removeCollection:function(){this.$store.dispatch("walls/collections/removeCollection",{wall:this.wall,collection:this.collection})},initCreateCard:function(){this.showCardSeed=!0,this.$nextTick(function(t){this.$refs.cardSeed.setFocus()})},createCard:function(t){var e=this;this.createCardInCollection({collection:this.collection,title:t}).then(function(){document.activeElement.blur(),e.initCreateCard()})},cancelCardSeed:function(){this.showCardSeed=!1},updateTitle:function(t){k.put("walls/"+this.collection.rid+"/collections/"+this.collection.rid,{title:t}).then(function(t){console.log(t)})},handleScroll:function(){w.$emit("relationsUpdated")}},Object(r.b)("walls/collections",["createCardInCollection","setCardOrder"])),mounted:function(){this.$refs.collectionContent.addEventListener("scroll",this.handleScroll)}},Pt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"drag-and-drop",rawName:"v-drag-and-drop:options",value:t.dndOptions,expression:"dndOptions",arg:"options"}],staticClass:"Collection"},[n("div",{staticClass:"collectionHeader z1"},[n("span"),t._v(" "),n("EditableInput",{attrs:{tag:"h2"},on:{change:function(e){return t.updateTitle(e)}},model:{value:t.collection.data.title,callback:function(e){t.$set(t.collection.data,"title",e)},expression:"collection.data.title"}}),t._v(" "),n("drop-down",{attrs:{items:[{label:"Radera samling",f:t.removeCollection}]}},[n("card-button",[n("widget-icon",{attrs:{path:"/static/graphics/icons/dropdown/",img:"KEDJA-14.png",imgHover:"KEDJA-15.png"}})],1)],1)],1),t._v(" "),n("div",{ref:"collectionContent",staticClass:"collectionContent"},[n("ul",{on:{reordered:t.reordered}},t._l(t.cards,function(e){return n("li",{key:e.rid,attrs:{"data-id":e.rid}},[n("card",{attrs:{card:e,id:e.rid,collection:t.collection,tabindex:"0"}})],1)}),0),t._v(" "),n("transition",{attrs:{name:"fade",mode:"out-in"}},[t.showCardSeed?n("card-seed",{ref:"cardSeed",attrs:{tabindex:"0"},on:{create:t.createCard,cancel:t.cancelCardSeed}}):t._e()],1)],1),t._v(" "),n("div",{staticClass:"collectionFooter z1"},[n("button",{staticClass:"fullWidth",attrs:{title:"Lägg till nytt kort",disabled:t.newDisabled},on:{click:t.initCreateCard}},[t._v("+ Nytt kort")])])])},staticRenderFns:[]};var Kt={name:"Collections",components:{Collection:n("VU/8")(Tt,Pt,!1,function(t){n("sib1")},"data-v-dd4a69c2",null).exports},props:{collections:Array,wall:Object},methods:s()({},Object(r.b)("walls/collections",["createCollection","removeCollection"])),mounted:function(){this.$emit("mounted")}},Ht={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"collections",staticClass:"Collections"},[t._l(t.collections,function(e){return n("collection",{key:e.rid,staticClass:"collection",attrs:{collection:e,wall:t.wall}})}),t._v(" "),n("div",{staticClass:"newCollection",attrs:{tabindex:"0"},on:{click:function(e){return t.createCollection(t.wall)}}},[n("button",{staticClass:"new",attrs:{title:"Lägg till ny samling"}},[t._v("+")])])],2)},staticRenderFns:[]};var Mt=n("VU/8")(Kt,Ht,!1,function(t){n("8C6H")},"data-v-6ffd749a",null).exports,Jt={name:"Connections",data:function(){return{loaded:!1,bounds:{},scroll:{}}},props:{connections:Array,wall:Object,collectionsElement:void 0},computed:s()({connectionCards:function(){var t=this;return this.connections.map(function(e){return{members:[t.cards[e.members[0]],t.cards[e.members[1]]]}})}},Object(r.e)("walls/cards",["cards"]),Object(r.e)(["userState"])),methods:{redraw:function(){var t=this;this.$nextTick(function(){t.setBounds(),t.drawCanvas()})},setBounds:function(){var t=this.$el.querySelector("canvas");t.width=this.$el.clientWidth,t.height=this.$el.clientHeight,this.bounds=this.collectionsElement.getBoundingClientRect(),this.scroll={left:this.collectionsElement.scrollLeft,top:this.collectionsElement.scrollTop}},drawCanvas:function(){var t=this,e=this.$el.querySelector("canvas"),n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),this.connectionCards.forEach(function(e){t.drawConnection(n,e)})},drawConnection:function(t,e){var n=e.members[0],a=e.members[1],i=document.getElementById(n.rid),s=document.getElementById(a.rid);if(i&&s){var r=void 0,o=void 0,c=void 0,l=void 0;i.getBoundingClientRect().x<s.getBoundingClientRect().x?(r=i,o=s,c=n.states.selected||n.states.selectingConnected||n.states.connectingConnected,l=a.states.selected||a.states.selectingConnected||a.states.connectingConnected):(r=s,o=i,c=a.states.selected||a.states.selectingConnected||a.states.connectingConnected,l=n.states.selected||n.states.selectingConnected||n.states.connectingConnected);var d=r.getBoundingClientRect().x+r.getBoundingClientRect().width-this.bounds.x+this.scroll.left,u=r.getBoundingClientRect().y+r.getBoundingClientRect().height/2-this.bounds.y,f=o.getBoundingClientRect().x-this.bounds.x+this.scroll.left,h=o.getBoundingClientRect().y+o.getBoundingClientRect().height/2-this.bounds.y;t.lineWidth=5,t.strokeStyle="#ffff",t.fillStyle="#ffdc27";var m=15;"selectCard"!==this.userState.name&&"connectCard"!==this.userState.name||c&&l||(t.lineWidth=1,t.strokeStyle="#fff5",t.fillStyle="#ffdc2722",m=10),t.beginPath(),t.moveTo(d+5,u),t.lineTo(f-5,h),t.stroke(),t.beginPath(),t.arc(d,u,m,-Math.PI/2,Math.PI/2),t.fill(),t.beginPath(),t.arc(f,h,m,Math.PI/2,-Math.PI/2),t.fill()}}},created:function(){w.$on("relationsUpdated",this.redraw),w.$on("cardRemoved",this.redraw)},mounted:function(){this.collectionsElement&&this.$nextTick(this.redraw)}},qt={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"Connections"},[e("canvas",{staticClass:"canvasConnection"})])}]};var zt={private_wall:"Privat vägg",public_wall:"Publik vägg"},Gt={name:"Wall",components:{UserButton:m,DropDown:u,CardFilter:Ut,Collections:Mt,Connections:n("VU/8")(Jt,qt,!1,function(t){n("HmYq")},"data-v-abe3efee",null).exports,EditableInput:Wt},data:function(){return{aclNames:zt,collectionsElement:void 0}},props:{rid:Number,wall:Object},computed:s()({collections:function(){return this.getWallCollections(this.wall)},relations:function(){return this.wall.relations},users:function(){return this.getUsers(this.wall.userList)},otherUsers:function(){var t=this;return this.users.filter(function(e){return e.rid!==t.currentUser.rid})},aclOptions:function(){var t=this;return ht()(zt).filter(function(e){return t.wall.data.acl_name!==e}).map(function(e){return{label:zt[e],f:t.setWallACL,args:{wall:t.wall,aclName:e}}})}},Object(r.e)("walls",["walls"]),Object(r.e)(["userState","filterCards"]),Object(r.c)("users",["currentUser","getUsers"]),Object(r.c)("walls",["getWallCollections"])),methods:s()({userColor:function(t){return b(t)},openUserModal:function(t){w.$emit("modalOpen",{component:_t,data:{user:t,wall:this.wall}})},openUserAdminModal:function(t){var e=this;w.$emit("modalOpen",{component:pt,data:{users:this.getUsers().filter(function(t){return t.rid!==e.currentUser.rid}),wall:this.wall}})},removeWall:function(){var t=this;$({message:"Är du säker på att du vill radera väggen och dess innehåll?",action:function(){k.delete("walls/"+t.rid).then(function(e){t.$router.push({name:"Walls"})})}})},updateTitle:function(t){k.put("walls/"+this.rid,{title:t})},redrawConnections:function(){this.$refs.connections&&this.$refs.connections.redraw()},collectionsMounted:function(){this.$refs.colls.addEventListener("scroll",this.redrawConnections),this.collectionsElement=this.$refs.collections.$el}},Object(r.b)("walls",["setWallACL"])),created:function(){var t=this;w.$on("collectionCreated",function(){t.$nextTick(function(){document.activeElement.scrollIntoView({behavior:"smooth",inline:"start"})})}),w.$on("collectionRemoved",function(){t.$nextTick(function(){document.querySelector("#collections .horisontal-scroll-wrapper").scrollIntoView({behavior:"smooth",inline:"end"})})})}},Yt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.wall?n("div",{staticClass:"Wall"},[n("div",{staticClass:"wallHeader"},[n("drop-down",{attrs:{items:[{label:"Radera vägg",f:t.removeWall}]}},[n("EditableInput",{attrs:{tag:"h2"},on:{change:function(e){return t.updateTitle(e)}},model:{value:t.wall.data.title,callback:function(e){t.$set(t.wall.data,"title",e)},expression:"wall.data.title"}}),t._v(" ▿\n    ")],1),t._v(" "),n("drop-down",{attrs:{items:t.aclOptions}},[t._v("\n      "+t._s(t.aclNames[t.wall.data.acl_name])+" ▿\n    ")]),t._v(" "),n("card-filter",{nativeOn:{click:function(t){t.stopPropagation()}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"users"},[n("user-button",{staticClass:"self",attrs:{user:t.currentUser,small:""},on:{click:function(e){return t.openUserModal(t.currentUser)}}}),t._v(" "),t._l(t.otherUsers,function(e,a){return n("user-button",{key:e.rid,attrs:{color:t.userColor(a),user:e,small:""},on:{click:function(n){return t.openUserModal(e)}}})}),t._v(" "),n("button",{staticClass:"add-user-button",on:{click:t.openUserAdminModal}},[t._v("+")])],2)],1),t._v(" "),n("div",{ref:"wallContent",staticClass:"wallContent"},[n("div",{ref:"colls",attrs:{id:"collections"}},[n("div",{staticClass:"horisontal-scroll-wrapper"},[n("collections",{ref:"collections",attrs:{collections:t.collections,wall:t.wall},on:{mounted:t.collectionsMounted}}),t._v(" "),t.relations?n("connections",{ref:"connections",staticClass:"connections",attrs:{collectionsElement:t.collectionsElement,wall:t.wall,connections:t.relations}}):t._e()],1)])]),t._v(" "),n("div",{staticClass:"wallFooter"})]):n("div",[t._v("\n  Loading....\n")])},staticRenderFns:[]};var Zt={name:"ViewWall",components:{KedjaHeader:y,Wall:n("VU/8")(Gt,Yt,!1,function(t){n("KhCJ"),n("U9zc")},"data-v-5a6dc2ef",null).exports},data:function(){return{rid:NaN}},computed:s()({wall:function(){return this.rid&&this.walls[this.rid]}},Object(r.e)("walls",["walls"])),methods:s()({getWallFromParam:function(){this.rid=Number(this.$route.params.wallId),this.rid&&(this.fetchWall(this.rid),this.setActiveWallId(this.rid))},createCollection:function(){var t=this;k.post("walls/"+this.wall.rid+"/collections",{title:"Ny samling"}).then(function(e){console.log(e),t.wall.collections.push(e.data)})},resetUserState:function(){this.$store.commit("resetUserState")}},Object(r.d)("walls",["setActiveWallId"]),Object(r.b)("walls",["fetchWall"])),mounted:function(){this.getWallFromParam()}},Xt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ViewWall",on:{click:this.resetUserState}},[e("kedja-header"),this._v(" "),e("div",{staticClass:"content"},[this.rid?e("wall",{staticClass:"mywall",attrs:{rid:this.rid,wall:this.wall}}):this._e()],1)],1)},staticRenderFns:[]};var Qt=n("VU/8")(Zt,Xt,!1,function(t){n("BGZ6")},"data-v-ba0a6178",null).exports;a.a.use(T.a);var te,ee=new T.a({mode:"history",routes:[{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:q},{path:"/logging_in",name:"LoggingIn",component:Y},{path:"/register",name:"Register",component:Q},{path:"/home",name:"Home",component:H},{path:"/profile",name:"Profile",component:nt},{path:"/walls",name:"Walls",component:ut},{path:"/walls/:wallId",name:"ViewWall",component:Qt}]}),ne=n("bOdI"),ae=n.n(ne),ie=n("gRE1"),se=n.n(ie),re=function(t,e){return t.find(function(t){return t.cardList.includes(e.rid)})},oe=function(t,e){var n=t.indexOf(e);return[t[n-1],t[n+1]].filter(function(t){return void 0!==t})},ce=function(t,e){return t.findIndex(function(t){return t.cardList.includes(e)})},le={namespaced:!0,modules:{collections:{namespaced:!0,state:{collections:{}},getters:{getCollectionByCard:function(t){return function(e){return se()(t.collections).find(function(t){return t.cardList.includes(e.rid)})}}},actions:{removeCard:function(t,e){var n=t.commit,a=t.getters,i=t.rootGetters,s=a.getCollectionByCard(e),r=i["walls/activeWall"],o=function(){k.delete("collections/"+s.rid+"/cards/"+e.rid).then(function(t){n("walls/removeCardRelations",{wall:r,card:e},{root:!0}),n("removeCard",{collection:s,card:e}),n("walls/cards/removeCard",e,{root:!0}),n("resetUserState",null,{root:!0}),w.$emit("cardRemoved")})};r.relations.find(function(t){return t.members.includes(e.rid)})?$({message:"Om du raderar detta kort tas även kopplingar till andra kort bort.",action:o}):o()},createCardInCollection:function(t,e){var n=t.commit,a=e.collection,i=e.title;k.post("collections/"+a.rid+"/cards",{title:i}).then(function(t){n("walls/cards/setCard",t.data,{root:!0}),n("addCard",{collection:a,card:t.data}),w.$emit("cardCreated")})},createCollection:function(t,e){var n=t.commit;t.rootGetters;k.post("walls/"+e.rid+"/collections",{title:"Ny samling"}).then(function(t){n("setCollection",t.data),n("walls/addCollectionToWall",{wall:e,collection:t.data},{root:!0}),w.$emit("collectionCreated")})},removeCollection:function(t,e){var n=t.commit,a=e.wall,i=e.collection,s=function(){k.delete("walls/"+a.rid+"/collections/"+i.rid).then(function(t){n("walls/removeCollectionFromWall",{wall:a,collection:i},{root:!0}),n("removeCollection",i),w.$emit("collectionRemoved")})};i.cardList.length?$({message:"Om du raderar denna samling raderas även samlingens kort och deras kopplingar.",action:s}):s()},setCardOrder:function(t,e){var n=t.commit,a=e.collection,i=e.order;n("setCollectionIdCardList",{collectionId:a.rid,cardList:i}),w.$emit("relationsUpdated"),k.put("collections/"+a.rid+"/order",{order:i}).then(function(t){n("walls/cards/setCards",t.data,{root:!0});var e=t.data.map(function(t){return t.rid});n("setCollectionIdCardList",{collectionId:a.rid,cardList:e}),w.$emit("relationsUpdated")})}},mutations:{setCollections:function(t,e){e.forEach(function(e){t.collections[e.rid]?a.a.set(t.collections[e.rid],"data",e.data):a.a.set(t.collections,e.rid,e)})},addCard:function(t,e){var n=e.collection,a=e.card;n.cardList.push(a.rid)},setCollection:function(t,e){t.collections[e.rid]?a.a.set(t.collections[e.rid],"data",e.data):(e.cardList=e.cardList||[],a.a.set(t.collections,e.rid,e))},setCollectionIdCardList:function(t,e){var n=e.collectionId,i=e.cardList;a.a.set(t.collections[n],"cardList",i)},removeCollection:function(t,e){delete t.collections[e.rid]},removeCard:function(t,e){var n=e.collection,a=e.card;n.cardList.splice(n.cardList.indexOf(a.rid),1)}}},cards:{namespaced:!0,state:{cards:{}},getters:{getList:function(t){return function(e){return(e||[]).map(function(e){return t.cards[e]})}}},mutations:{setCard:function(t,e){var n=t.cards[e.rid]||e;e.states=n.states||{},a.a.set(t.cards,e.rid,e)},setCards:function(t,e){e.forEach(function(e){var n=t.cards[e.rid]||e;e.states=n.states||{},a.a.set(t.cards,e.rid,e)})},removeCard:function(t,e){delete t.cards[e.rid]},setCardState:function(t,e){var n=e.rid,i=e.stateName,s=e.stateFlag;a.a.set(t.cards[n].states,i,s),w.$emit("relationsUpdated")},resetCardState:function(t,e){var n=e.rid,i=e.stateName;a.a.set(t.cards[n].states,i,void 0),w.$emit("relationsUpdated")},resetCardStates:function(t,e){var n=e.rid;a.a.set(t.cards[n],"states",{}),w.$emit("relationsUpdated")}}}},state:{walls:{},wallList:[],activeWallId:NaN},getters:{all:function(t){return t.wallList.map(function(e){return t.walls[e]})},activeWall:function(t){return t.activeWallId&&t.walls[t.activeWallId]},getWallCollections:function(t){return function(e){return e&&e.collectionList&&e.collectionList.map(function(e){return t.collections.collections[e]})}},activeWallCollections:function(t,e){return e.getWallCollections(e.activeWall)},getCollectionCards:function(t){return function(e){return e.cardList.map(function(e){return t.cards.cards[e]})}},getClosestCardCousins:function(t,e){return function(t){var n=e.activeWallCollections,a=re(n,t);return oe(n,a).reduce(function(t,n){return t.concat(e.getCollectionCards(n))},[])}},getRecursiveConnectionsByCardId:function(t,e){return function(t,n,a){var i=e.activeWallCollections;if(!t)return[];var s=[],r=[];t.filter(function(t){return t.members.includes(n)}).forEach(function(t){var e=ce(i,t.members[0]),o=ce(i,t.members[1])>e?1:0,c=+!t.members.indexOf(n);a===(o===c)&&(s.push(t.members[c]),r.push(t))});var o=[];return s.forEach(function(n){o=o.concat(e.getRecursiveConnectionsByCardId(t,n,a))}),r=r.concat(o)}},getDeepConnectionsByCardId:function(t,e){return function(t){var n=e.activeWall.relations,a=e.getRecursiveConnectionsByCardId(n,t,!0);return a=a.concat(e.getRecursiveConnectionsByCardId(n,t,!1))}},getDirectConnectionsByCardId:function(t,e){return function(t){return e.activeWall.relations.filter(function(e){return-1!==e.members.indexOf(t)})}}},actions:{fetchWalls:function(t){var e=t.commit;k.get("walls").then(function(t){e("setWalls",t.data)})},createWall:function(t){var e=t.commit;k.post("walls",{title:"Ny vägg"}).then(function(t){e("setWall",t.data)})},fetchWall:function(t,e){var n=t.commit;t.rootState,t.rootGetters;C.a.all([k.get("walls/"+e),k.get("walls/"+e+"/collections"),k.get("walls/"+e+"/relations")]).then(C.a.spread(function(t,e,a){t.data.collectionList=e.data.map(function(t){return t.rid}),n("setWall",t.data),n("collections/setCollections",e.data),C.a.all(e.data.map(function(t){return k.get("collections/"+t.rid+"/cards")})).then(C.a.spread(function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];s.forEach(function(t,a){n("cards/setCards",t.data),n("collections/setCollectionIdCardList",{collectionId:e.data[a].rid,cardList:t.data.map(function(t){return t.rid})})}),n("setRelationsData",{wall:t.data,relations:a.data})}))}))},createRelation:function(t,e){var n=t.commit,a=t.state,i=e.wall,s=e.cards;k.post("walls/"+a.activeWallId+"/relations",{members:s.map(function(t){return t.rid})}).then(function(t){n("addRelation",{wall:i,relation:t.data})})},deleteRelation:function(t,e){var n=t.commit,a=t.state,i=e.wall,s=e.relation;k.delete("walls/"+a.activeWallId+"/relations/"+s.relation_id).then(function(t){n("removeRelation",{wall:i,relationId:t.data.removed})})},setWallACL:function(t,e){var n=t.commit,a=(t.state,e.wall),i=e.aclName;k.put("walls/"+a.rid+"/acl",{acl_name:i}).then(function(t){n("setWallACL",{wall:a,aclName:t.data.acl_name})})}},mutations:{setWalls:function(t,e){e.forEach(function(n){t.walls[n.rid]?a.a.set(t.walls[n.rid],"data",n.data):a.a.set(t.walls,n.rid,n),t.wallList=e.map(function(t){return t.rid})})},setActiveWallId:function(t,e){t.activeWallId=e},setWall:function(t,e){a.a.set(t.walls,e.rid,e),t.wallList.includes(e.rid)||t.wallList.push(e.rid)},setWallACL:function(t,e){var n=e.wall,i=e.aclName;a.a.set(n.data,"acl_name",i)},removeCardRelations:function(t,e){var n=e.wall,i=e.card;a.a.set(n,"relations",n.relations.filter(function(t){return!t.members.includes(i.rid)})),w.$emit("relationsUpdated")},addRelation:function(t,e){var n=e.wall,a=e.relation;n.relations.push(a),w.$emit("relationsUpdated")},removeRelation:function(t,e){var n=e.wall,i=e.relationId;a.a.set(n,"relations",n.relations.filter(function(t){return t.relation_id!==i})),w.$emit("relationsUpdated")},setRelationsData:function(t,e){var n=e.wall,i=e.relations;a.a.set(n,"relations",i),w.$emit("relationsUpdated")},addCollectionToWall:function(t,e){var n=e.wall,a=e.collection;n.collectionList.push(a.rid)},removeCollectionFromWall:function(t,e){var n=e.wall,a=e.collection;n.collectionList.splice(n.collectionList.indexOf(a.rid),1)},addUser:function(t,e){var n=e.wall,a=e.user;n.userList.push(a.rid)},removeUser:function(t,e){var n=e.wall,a=e.user;n.userList.splice(n.userList.indexOf(a.rid),1)}}},de=n("mvHQ"),ue=n.n(de),fe=function(t){return[t.data.first_name,t.data.last_name].filter(function(t){return t}).join(" ")},he=function(t){return[t.data.first_name[0],t.data.last_name[0]].filter(function(t){return t}).join("").toUpperCase()},me={namespaced:!0,state:{currentUserId:NaN,data:{}},mutations:{setCurrentUserId:function(t,e){t.currentUserId=e,e||delete localStorage.userData},setUserData:function(t,e){Array.isArray(e)||(e=[e]),e.forEach(function(e){e.data.fullName=fe(e),e.data.shortName=he(e),a.a.set(t.data,e.rid,e),e.rid===t.currentUserId&&(localStorage.userData=ue()(e))})},loadUserFromLocalStorage:function(t){if(localStorage.userData)try{var e=JSON.parse(localStorage.userData);t.currentUserId=e.rid,a.a.set(t.data,e.rid,e)}catch(t){console.log("Could not load userData",t)}}},getters:{getUsers:function(t){return function(e){return e?e.map(function(e){return t.data[e]}):se()(t.data)}},currentUser:function(t){return t.data[t.currentUserId]}},actions:{fetchUserData:function(t,e){var n=t.commit;k.get("users/"+e).then(function(t){n("setUserData",t.data)})}}};a.a.use(r.a);var ve=new r.a.Store({modules:{walls:le,users:me},state:{connections:[],tabIndexCounter:0,connectionBounds:"",userState:{},auth:"",userid:"",userData:{},filterCards:!1},mutations:(te={},ae()(te,"resetUserState",function(t){ve.commit("setUserState",{name:"default"})}),ae()(te,"setUserState",function(t,e){var n=e.name,i=e.data;w.$emit("relationsUpdated"),a.a.set(t,"userState",{name:n,data:i||{},rand:Math.random()})}),ae()(te,"setFilterCards",function(t,e){a.a.set(t,"filterCards",e),w.$emit("relationsUpdated")}),te),actions:{authenticate:function(t){var e=t.dispatch;t.getters.isAuthenticated&&k.get("auth/valid").then(function(t){t.data.userid||e("logout")})},login:function(t,e){var n,a=t.commit;n=e.Authorization,localStorage.auth=n,k.defaults.headers.Authorization=n,a("users/setCurrentUserId",e.user.rid),a("users/setUserData",e.user)},logout:function(t){(0,t.commit)("users/setCurrentUserId",NaN)}},getters:{isAuthenticated:function(t){return!!t.users.currentUserId},userData:function(t){return t.users.data[t.users.currentUserId]}}}),pe=n("8Avr"),ge=n("/OPg"),Ce=n.n(ge);n("2PJM");a.a.use(Ce.a),a.a.use(pe.a),a.a.config.productionTip=!1,new a.a({el:"#app",router:ee,store:ve,components:{App:B},template:"<App/>"})},OtJe:function(t,e){},RWOq:function(t,e){},S2Bu:function(t,e){},U9zc:function(t,e){},ejGu:function(t,e){},gmtP:function(t,e){},"m/Pj":function(t,e){},oTiU:function(t,e){},sib1:function(t,e){},tFfL:function(t,e){},tjhX:function(t,e){},v0MC:function(t,e){},x5WV:function(t,e){},y0aV:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.1664ed8aca1da8756eaf.js.map