webpackJsonp([1],{"/R0z":function(t,e){},"49WQ":function(t,e){},"9gss":function(t,e){},ACCM:function(t,e){},Jb4x:function(t,e){},"L+Cv":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),o=n("lHA8"),a=n.n(o),c=n("Gu7T"),s=n.n(c),r=n("2aIq"),l=n.n(r),d=n("NYxO"),u=n("mtWM"),m=n.n(u),f=(n("VU/8")({Wall:function(t){return{name:"Ny vägg",collections:[]}},Collection:function(t){return{name:"Ny samling",cards:[]}},Card:function(t){return{name:"Nytt kort",id:"",states:{}}}},null,!1,null,null,null).exports,n("lhjn"),this);i.a.use(d.a);var h=new d.a.Store({state:{walls:[],activeWallId:0,activeWall:"",connections:[],tabIndexCounter:0,connectionBounds:"",userState:"",auth:""},mutations:{init:function(t,e){l()(e),h.commit("setAuthFromLocalStorage")},setAuthFromLocalStorage:function(t){"undefined"!=typeof Storage?t.auth=localStorage.getItem("auth"):console.log("No local storage support"),console.log(t.auth)},setAuth:function(t,e){var n=e.auth;"undefined"!=typeof Storage?localStorage.setItem("auth",n):console.log("No local storage support"),h.commit("setAuthFromLocalStorage")},resetAuth:function(t){"undefined"!=typeof Storage?localStorage.removeItem("auth"):console.log("No local storage support"),h.commit("setAuthFromLocalStorage")},resetUserState:function(t){h.commit("setUserState",{name:"default"})},setUserState:function(t,e){var n=e.name,i=e.data;h.commit("setDirtyDraw"),t.userState={name:n,data:i||{},rand:Math.random()}},forceUserStateUpdate:function(t){h.commit("setDirtyDraw"),t.userState.rand=Math.random()},setActiveWall:function(t,e){var n=e.wall;t.activeWall=n},setWallCollections:function(t,e){var n=e.wall,o=e.collections;i.a.set(n,"collections",o)},setWallConnections:function(t,e){var n=e.wall,o=e.connections;i.a.set(n,"connections",o)},setCollectionCards:function(t,e){var n=e.collection,o=e.cards;i.a.set(n,"cards",o)},setConnections:function(t,e){var n=e.connections;t.connections=n},initWall:function(t,e){i.a.set(e,"collections",[]),i.a.set(e,"connections",[]),i.a.set(e,"dirtyDraw",!1)},initCollection:function(t,e){i.a.set(e,"cards",[])},initCard:function(t,e){i.a.set(e,"states",{})},initConnection:function(t,e){i.a.set(e,"dirtyDraw",!1)},setCardsState:function(t,e){var n=e.cards,i=e.cardIds,o=e.stateName,a=e.stateFlag,c=e.invertCollection;if(console.log("Set cards state: "+o),console.log(i),n)n=c?h.getters.getCardsInverted(n):n;else{h.getters.getActiveWall();n=c?h.getters.getCardsByIdsInverted(i):h.getters.getCardsByIds(i)}n.forEach(function(t,e){h.commit("setCardState",{card:t,stateName:o,stateFlag:a})})},resetCardState:function(t,e){e.card;h.getters.getActiveWall().collections.forEach(function(t,e){t.cards.forEach(function(t,e){h.commit("setCardState",{card:t,stateName:stateName,stateFlag:void 0})})})},resetCardsState:function(t,e){e.cardIds;var n=e.stateName;h.getters.getActiveWall().collections.forEach(function(t,e){t.cards.forEach(function(t,e){h.commit("setCardState",{card:t,stateName:n,stateFlag:void 0})})})},setCardState:function(t,e){var n=e.card,o=e.stateName,a=e.stateFlag;i.a.set(n.states,o,a)},createWall:function(t,e){l()(e);var n={endpoint:"walls",params:{title:"Ny vägg"},method:"post",successCallback:function(e){t.walls.push(e.data)}};h.commit("makeAPICall",n)},setDirtyDraw:function(t){var e=h.getters.getActiveWall();i.a.set(e,"dirtyDraw",!0),t.connectionBounds=document.getElementsByClassName("collectionContent")[0].getBoundingClientRect(),i.a.nextTick().then(function(){i.a.set(e,"dirtyDraw",!1)})},createConnection:function(t,e){var n=e.card0,i=e.card1;console.log("Connect cards: "+n.rid+" and "+i.rid);var o={endpoint:"walls/"+n.rid+"/"+i.rid,params:{},method:"post",successCallback:function(t){console.log(t)}};h.commit("makeAPICall",o)},addConnectionToWall:function(t,e){var n=e.wall,i=e.connection;n.connections.push(i)},removeConnection:function(t,e){var n=e.card0,i=e.card1;console.log("Unconnect cards: "+n.rid+" and "+i.rid);var o={endpoint:"delete_relation/"+n.rid+"/"+i.rid,params:{},method:"delete",successCallback:function(t){console.log(t)}};h.commit("makeAPICall",o)},setDeepConnectionsByCardId:function(t,e){var n=e.id;console.log("Set deep connections"),t.connections=h.getters.getDeepConnectionsByCardId(n)},resetConnections:function(t){console.log("Reset connections"),t.connections=[],console.log(t.connections.length)},setCanConnectByCardId:function(t,e){var n=e.id,i=h.getters.getCollectionByCardId(n);console.log(i);var o=h.getters.getActiveWall(),a=h.getters.getClosestArraySiblings(o.collections,i);console.log(a),a.forEach(function(t,e){t&&t.cards.forEach(function(t,e){h.commit("setCardState",{card:t,stateName:"connectingCanConnect",stateFlag:!0})})})},makeAPICall:function(t,e){var n=e.method?e.method:"get";m()({method:n,url:"https://staging-server.kedja.org/api/1/"+e.endpoint,params:e.params,data:e.data}).then(e.successCallback,f.errorCallback).catch(function(t){console.log(t)})},errorCallback:function(t,e){console.log("Error"),console.log(e)}},getters:{getAuth:function(t){return t.auth},getUserState:function(t){return t.userState},getActiveWall:function(t){return function(){return t.activeWall}},getCardById:function(t){return function(t){var e=void 0;return h.getters.getActiveWall().collections.forEach(function(n,i){var o=n.cards.find(function(e){return e.rid==t});o&&(e=o)}),e}},getCardsByIds:function(t){return function(t){var e=[];return h.getters.getActiveWall().collections.forEach(function(n,i){e=e.concat(n.cards.filter(function(e){return-1!=t.indexOf(e.rid)}))}),e}},getCardsByIdsInverted:function(t){return function(t){var e=[];return h.getters.getActiveWall().collections.forEach(function(n,i){e=e.concat(n.cards.filter(function(e){return-1==t.indexOf(e.rid)}))}),e}},getCardsInverted:function(t){return function(t){var e=[];return h.getters.getActiveWall().collections.forEach(function(n,i){e=e.concat(n.cards.filter(function(e){return-1==t.indexOf(e)}))}),e}},getClosestCardCousins:function(t){return function(t){var e=h.getters.getCollectionByCard(t),n=h.getters.getActiveWall(),i=[];return h.getters.getClosestArraySiblings(n.collections,e).forEach(function(t,e){t&&(i=i.concat(t.cards))}),i}},getCollectionByCard:function(t){return function(t){return h.getters.getActiveWall().collections.find(function(e){return-1!=e.cards.indexOf(t)})}},getCardsByState:function(t){return function(t){var e=[];return h.getters.getActiveWall().collections.forEach(function(n,i){e=e.concat(n.cards.filter(function(e){return e.states[t]}))}),e}},getDirectConnectionsByCardId:function(t){return function(t){var e=h.getters.getActiveWall();return e.connections?e.connections.filter(function(e){return-1!=e.members.indexOf(t)}):[]}},getDeepConnectionsByCardId:function(t){return function(t){var e=h.getters.getActiveWall().connections,n=h.getters.getRecursiveConnectionsByCardId(e,t,!0);return n=n.concat(h.getters.getRecursiveConnectionsByCardId(e,t,!1)),n=[].concat(s()(new a.a(n)))}},getRecursiveConnectionsByCardId:function(t){return function(t,e,n){if(!t)return[];var i=t.filter(function(t){return t.members[+!n]==e}),o=[];return i.forEach(function(e,i){o=o.concat(h.getters.getRecursiveConnectionsByCardId(t,e.members[+n],n))}),i=i.concat(o)}},getClosestArraySiblings:function(t){return function(t,e){if(!t)return[];var n=[void 0,void 0],i=t.indexOf(e);return i>0&&(n[0]=t[i-1]),i<t.length-1&&(n[1]=t[i+1]),n}},getTreeById:function(t){return function(t){}},getWalls:function(t){return function(){return t.walls}}}}),v={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"KedjaLogo"},[e("router-link",{attrs:{to:{name:"Login",params:{}}}},[this._v("\n    KEDJA.\n  ")])],1)},staticRenderFns:[]};var g=n("VU/8")({name:"KedjaLogo",data:function(){return{}},props:{},computed:{},methods:{},mounted:function(){}},v,!1,function(t){n("L+Cv")},"data-v-4e450939",null).exports,p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"DropDown"},[t._t("default"),t._v(" "),n("div",{staticClass:"listContainer"},[n("div",{staticClass:"list"},t._l(t.items,function(e){return n("div",{staticClass:"listItem",on:{click:function(n){return t.performFunction(e.f)}}},[t._v("\n        "+t._s(e.label)+"\n      ")])}),0)])],2)},staticRenderFns:[]};var C=n("VU/8")({name:"DropDown",data:function(){return{open:!1}},props:{items:""},computed:{},methods:{toggleList:function(){this.open=!this.open},performFunction:function(t){t&&t()}},mounted:function(){}},p,!1,function(t){n("vGR/")},"data-v-58010b4f",null).exports,_={name:"KedjaHeader",components:{KedjaLogo:g,DropDown:C},data:function(){return{}},props:{},computed:{auth:function(){return h.getters.getAuth}},methods:{logout:function(t){h.commit("resetAuth"),this.$router.push({name:"Login"})}},mounted:function(){}},b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"KedjaHeader"},[n("kedja-logo"),t._v(" "),n("div",{staticClass:"slot"},[t._t("default")],2),t._v(" "),n("div",[t.auth?n("div",[n("drop-down",{attrs:{items:[{label:"Min profil"},{label:"Mina väggar"},{label:"Logga ut",f:t.logout}]}},[t._v("\n        "+t._s(t.auth)+"\n      ")])],1):n("div",[n("router-link",{attrs:{to:{name:"Login"}}},[t._v("Logga in")])],1)])],1)},staticRenderFns:[]};var w=n("VU/8")(_,b,!1,function(t){n("Jb4x")},"data-v-0882af83",null).exports,k={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"KedjaHeader"})},staticRenderFns:[]};var x={name:"App",components:{KedjaHeader:w,KedjaFooter:n("VU/8")({name:"KedjaHeader",data:function(){return{}},props:{},computed:{},methods:{},mounted:function(){}},k,!1,function(t){n("/R0z")},"data-v-b2b84a16",null).exports},created:function(){h.commit("init",{})},mounted:function(){document.activeElement.blur()}},y={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view",{attrs:{id:"router"}}),this._v(" "),e("kedja-footer",{attrs:{id:"footer"}})],1)},staticRenderFns:[]};var I=n("VU/8")(x,y,!1,function(t){n("ACCM")},null,null).exports,S=n("/ocq"),A={name:"WrapperComponent",render:function(t){return t(this.tag,this.$slots.default)},props:{tag:{type:String,required:!0}}},E={name:"EditableInput",components:{WrapperComponent:n("VU/8")(A,null,!1,null,null,null).exports},props:{value:String,tag:"",placeholder:{default:"Ange text"},type:{default:"input"}},data:function(){return{editing:!1,textTemp:String,width:"",height:""}},computed:{inputVisible:function(){return this.editing||""==this.value}},watch:{},methods:{openEdit:function(){this.calcWidth(),this.editing=!0,this.textTemp=this.value,this.$nextTick(function(t){this.$refs.input.focus(),this.$refs.input.select()})},finishEdit:function(t){this.editing&&t&&this.emitToParent(),this.editing=!1},calcWidth:function(){this.$nextTick(function(){var t=this.$el.getElementsByClassName("textSpan")[0];t&&(this.width=t.offsetWidth,this.height=t.offsetHeight)})},emitToParent:function(){var t=""!==this.textTemp.trim()?this.textTemp:this.placeholder;this.$emit("input",t),this.$emit("change",t)}}},W={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"EditableInput",class:{fullWidth:t.inputVisible}},[n("wrapper-component",{staticClass:"text",attrs:{tag:t.tag,id:"eiTemp"}},[t.inputVisible?t._e():n("div",{staticClass:"textContainer",on:{click:function(e){return t.openEdit()}}},[n("span",{staticClass:"textSpan"},[t._v("\n        "+t._s(t.value)+"\n      ")])]),t._v(" "),t.inputVisible?n("div",["input"==t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:t.textTemp,expression:"textTemp"}],ref:"input",style:{height:t.height+"px"},attrs:{placeholder:t.placeholder},domProps:{value:t.textTemp},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.finishEdit(!1)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.finishEdit(!0)}],blur:function(e){return t.finishEdit(!0)},input:function(e){e.target.composing||(t.textTemp=e.target.value)}}}):t._e(),t._v(" "),"textarea"==t.type?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textTemp,expression:"textTemp"}],ref:"input",style:{width:t.width+"px",height:t.height+"px"},attrs:{placeholder:t.placeholder},domProps:{value:t.textTemp},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.finishEdit(!1)},blur:function(e){return t.finishEdit(!0)},change:t.calcWidth,input:function(e){e.target.composing||(t.textTemp=e.target.value)}}}):t._e()]):t._e()])],1)},staticRenderFns:[]};var B=n("VU/8")(E,W,!1,function(t){n("lvSG")},"data-v-cfc598d0",null).exports,P={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"CardButton",class:{active:this.active}},[this._t("default")],2)},staticRenderFns:[]};var D=n("VU/8")({name:"CardButton",data:function(){return{}},props:{active:!1},computed:{},methods:{},mounted:function(){}},P,!1,function(t){n("OhUg")},"data-v-5e0839b4",null).exports,$={name:"Card",components:{EditableInput:B,CardButton:D},data:function(){return{hovering:!1}},props:{card:"",prid:""},computed:{userState:function(){return h.getters.getUserState},selected:function(){return"selectCard"==this.userState.name&&this.userState.data.rid==this.card.rid},selectedConnected:function(){return 1==this.card.states.selectedConnected},connections:function(){return h.getters.getDirectConnectionsByCardId(this.card.rid)},connectedCardIds:function(){var t=this,e=[];return this.connections.forEach(function(n,i){n.members[0]!=t.card.rid&&-1==e.indexOf(n.members[0])&&e.push(n.members[0]),n.members[1]!=t.card.rid&&-1==e.indexOf(n.members[1])&&e.push(n.members[1])}),e},connecting:function(){return"connectCard"==this.userState.name&&this.userState.data.rid==this.card.rid},connected:function(){return!1},canConnect:function(){return this.card.states.canConnect}},watch:{userState:{deep:!0,handler:function(t){(this.resetStates(),"selectCard"==t.name&&t.data.rid==this.card.rid&&this.setState("selected",!0),"connectCard"==t.name)&&(t.data.rid==this.card.rid?(this.setState("selected",!0),this.setState("connecting",!0)):-1!=this.connectedCardIds.indexOf(t.data.rid)?this.setState("connected",!0):h.getters.getClosestCardCousins(this.card).find(function(e){return e.rid==t.data.rid})&&this.setState("canConnect",!0))}}},methods:{setState:function(t,e){this.card.states[t]=e},resetStates:function(){this.card.states={}},resetState:function(t){this.card.states[t]=void 0},clicked:function(){"connectCard"!=this.userState.name&&this.setSelected(),this.card.states.connecting&&this.setSelected(),this.card.states.canConnect&&this.connect(),this.card.states.connected&&this.unconnect()},setHovering:function(t){},setSelected:function(t){this.selected?h.commit("resetUserState"):h.commit("setUserState",{name:"selectCard",data:{rid:this.card.rid}})},toggleConnecting:function(t){console.log("connecting "+this.connecting),this.connecting?h.commit("setUserState",{name:"selectCard",data:{rid:this.card.rid}}):h.commit("setUserState",{name:"connectCard",data:{rid:this.card.rid}})},connect:function(){console.log("Connect");var t=h.getters.getCardsByState("connecting")[0];this.$emit("connect",{members:[t.rid,this.card.rid]})},unconnect:function(){console.log("Unconnect");var t=h.getters.getCardsByState("connecting")[0];this.$emit("unconnect",{members:[t.rid,this.card.rid]})},removeCard:function(){this.$emit("removeCard",this.card)},updateTitle:function(t){var e={endpoint:"collections/"+this.prid+"/cards/"+this.card.rid,data:{title:t},method:"put",successCallback:function(t){console.log(t.data)}};h.commit("makeAPICall",e)}},created:function(){h.commit("initCard",this.card)},mounted:function(){}},R={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Card",class:{selected:t.card.states.selected,selectedConnectedOther:0==t.card.states.selectedConnected,connected:t.card.states.connected,canConnect:t.card.states.canConnect,cannotConnect:0==t.canConnect&&!t.connecting,connectedOther:0==t.card.states.connected,connecting:t.connecting},on:{mouseenter:function(e){return t.setHovering(!0)},mouseleave:function(e){return t.setHovering(!1)}}},[n("div",{staticClass:"main",on:{"!click":function(e){return t.clicked(e)}}},[n("h3",[t._v("\n      "+t._s(t.card.data.title)+"\n    ")])]),t._v(" "),t.card.states.selected?n("div",{staticClass:"selectedButtons"},[n("card-button",{attrs:{active:t.card.states.connecting},nativeOn:{click:function(e){return t.toggleConnecting(e)}}},[t._v("🔗")])],1):t._e()])},staticRenderFns:[]};var F={name:"Collection",components:{DropDown:C,Card:n("VU/8")($,R,!1,function(t){n("jY9u")},"data-v-46127e0c",null).exports,EditableInput:B},data:function(){return{hovering:!1}},computed:{cards:function(){return this.collection.cards},cardsFiltered:function(){return this.cards}},props:{collection:"",prid:""},watch:{},methods:{setHovering:function(t){this.hovering=t},removeCollection:function(){this.$emit("removeCollection",this.collection)},getCardsFromAPI:function(){var t=this;console.log("Get cards");var e={endpoint:"collections/"+this.collection.rid+"/cards",successCallback:function(e){console.log(e),h.commit("setCollectionCards",{collection:t.collection,cards:e.data})}};h.commit("makeAPICall",e)},createCard:function(){var t=this,e={endpoint:"collections/"+this.collection.rid+"/cards",data:{title:"Nytt kort"},method:"post",successCallback:function(e){console.log(e),t.cards.push(e.data)}};h.commit("makeAPICall",e)},removeCard:function(t){var e=this,n={endpoint:"collections/"+this.collection.rid+"/cards/"+t.rid,method:"delete",successCallback:function(n){console.log(n);var i=e.collection.cards.indexOf(t);-1!=i&&e.collection.cards.splice(i,1)}};h.commit("makeAPICall",n)},updateTitle:function(t){var e={endpoint:"walls/"+this.prid+"/collections/"+this.collection.rid,data:{title:t},method:"put",successCallback:function(t){console.log(t.data)}};h.commit("makeAPICall",e)},connect:function(t){this.$emit("connect",t)},unconnect:function(t){this.$emit("unconnect",t)},handleScroll:function(){h.commit("setDirtyDraw")}},created:function(){h.commit("initCollection",this.collection)},mounted:function(){this.getCardsFromAPI(),this.$refs.collectionContent.addEventListener("scroll",this.handleScroll)}},U={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Collection",on:{mouseenter:function(e){return t.setHovering(!0)},mouseleave:function(e){return t.setHovering(!1)}}},[n("div",{staticClass:"collectionHeader"},[n("drop-down",{attrs:{items:[{label:"Exportera vägg som"},{label:"Versionshistorik"},{label:"Radera samling",f:t.removeCollection}]}},[n("EditableInput",{attrs:{tag:"h2"},on:{change:function(e){return t.updateTitle(e)}},model:{value:t.collection.data.title,callback:function(e){t.$set(t.collection.data,"title",e)},expression:"collection.data.title"}}),t._v(" ▿\n    ")],1)],1),t._v(" "),n("div",{ref:"collectionContent",staticClass:"collectionContent"},[n("transition-group",{staticClass:"cards",attrs:{name:"fade",mode:"out-in"}},t._l(t.cards,function(e,i){return n("card",{key:e.rid,attrs:{card:e,id:e.rid,prid:t.collection.rid,tabindex:"0"},on:{removeCard:t.removeCard,connect:t.connect,unconnect:t.unconnect}})}),1)],1),t._v(" "),n("div",{staticClass:"collectionFooter"},[n("button",{staticClass:"fullWidth",attrs:{title:"Lägg till nytt kort"},on:{click:t.createCard}},[t._v("Lägg till nytt kort")])])])},staticRenderFns:[]};var L=n("VU/8")(F,U,!1,function(t){n("iymu")},"data-v-42859e7f",null).exports,V={name:"Collections",components:{Collection:L},data:function(){return{}},props:{collections:"",prid:""},computed:{},watch:{},methods:{createCollection:function(){this.$emit("createCollection")},removeCollection:function(t){this.$emit("removeCollection",t)},connect:function(t){this.$emit("connect",t)},unconnect:function(t){this.$emit("unconnect",t)},handleScroll:function(){h.commit("setDirtyDraw")}},created:function(){},mounted:function(){this.$refs.collections.addEventListener("scroll",this.handleScroll)}},T={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"collections",staticClass:"Collections"},[t._l(t.collections,function(e){return n("collection",{staticClass:"collection",attrs:{collection:e,prid:t.prid},on:{removeCollection:t.removeCollection,connect:t.connect,unconnect:t.unconnect}})}),t._v(" "),n("button",{staticClass:"new",attrs:{title:"Lägg till ny samling"},on:{click:t.createCollection}},[t._v("+ Ny samling")])],2)},staticRenderFns:[]};var N={name:"Connection",data:function(){return{loaded:!1,x0:"",y0:"",x1:"",y1:""}},props:{connection:"",dirtyDraw:!1},computed:{yMin:function(){return h.state.connectionBounds.y},yMax:function(){return h.state.connectionBounds.y+h.state.connectionBounds.height},height:function(){return this.yMax-this.yMin},from:function(){return this.connection.members[0]},to:function(){return this.connection.members[1]},width:function(){return Math.abs(this.x1-this.x0)},left:function(){return Math.min(this.x0,this.x1)},top:function(){return Math.min(this.y0,this.y1)}},watch:{dirtyDraw:function(t){t&&this.redraw()}},methods:{firstDraw:function(){var t=document.getElementById(this.from),e=document.getElementById(this.to);t&&e?h.commit("setDirtyDraw"):setTimeout(this.firstDraw,100)},redraw:function(){this.setBounds(),this.drawCanvas()},setBounds:function(){if(document.getElementById(this.from)&&document.getElementById(this.to)){var t=document.getElementById(this.from),e=document.getElementById(this.to),n=void 0,i=void 0;t.getBoundingClientRect().x<e.getBoundingClientRect().x?(n=t,i=e):(n=e,i=t),this.x0=n.getBoundingClientRect().x+n.getBoundingClientRect().width,this.y0=n.getBoundingClientRect().y-this.yMin+n.getBoundingClientRect().height/2,this.x1=i.getBoundingClientRect().x,this.y1=i.getBoundingClientRect().y-this.yMin+i.getBoundingClientRect().height/2}},drawCanvas:function(){var t=this.$el.getElementsByTagName("canvas")[0],e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),e.lineWidth=6,e.strokeStyle="#ffffff",e.beginPath();var n=this.y0,i=this.y1;e.moveTo(0,n),e.lineTo(this.width/2,n),e.lineTo(this.width/2,i),e.lineTo(this.width,i),e.stroke(),e.lineWidth=3}},created:function(){h.commit("initConnection",this.connection)},mounted:function(){this.firstDraw()},updated:function(){this.redraw()}},O={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"Connection z0",style:{top:this.yMin+"px",left:this.left+"px"}},[e("canvas",{staticClass:"canvasConnection",attrs:{width:this.width,height:this.height}})])},staticRenderFns:[]};var j={name:"Wall",components:{KedjaHeader:w,DropDown:C,Collections:n("VU/8")(V,T,!1,function(t){n("49WQ")},"data-v-5caabd49",null).exports,Collection:L,Connection:n("VU/8")(N,O,!1,function(t){n("pUrj")},"data-v-482bc7e8",null).exports,EditableInput:B},data:function(){return{}},props:{wall:""},computed:{userState:function(){return h.getters.getUserState},data:function(){return this.wall.data},collections:function(){return this.wall.collections},connections:function(){return this.wall.connections}},watch:{wall:function(){h.commit("initWall",this.wall),this.getCollectionsFromAPI(),this.getConnectionsFromAPI()},collections:function(){}},methods:{getCollectionsFromAPI:function(){var t=this;console.log("get collections");var e=this.$route.params.wallId;if(e){var n={endpoint:"walls/"+e+"/collections",successCallback:function(e){console.log(e),h.commit("setWallCollections",{wall:t.wall,collections:e.data})}};h.commit("makeAPICall",n)}},getConnectionsFromAPI:function(){var t=this;console.log("get connections");var e=this.$route.params.wallId;if(e){var n={endpoint:"walls/"+e+"/relations",successCallback:function(e){console.log(e),h.commit("setWallConnections",{wall:t.wall,connections:e.data})}};h.commit("makeAPICall",n)}},getWallLocal:function(){this.wall=h.getters.getActiveWall()},createCollection:function(){var t=this,e={endpoint:"walls/"+this.wall.rid+"/collections",data:{title:"Ny samling"},method:"post",successCallback:function(e){console.log(e),t.collections.push(e.data)}};h.commit("makeAPICall",e)},removeWall:function(){var t=this,e={endpoint:"walls/"+this.wall.rid,method:"delete",successCallback:function(e){t.$router.push({name:"ViewWallList"})}};h.commit("makeAPICall",e)},removeCollection:function(t){var e=this,n={endpoint:"walls/"+this.wall.rid+"/collections/"+t.rid,method:"delete",successCallback:function(n){console.log(n);var i=e.wall.collections.indexOf(t);-1!=i&&e.wall.collections.splice(i,1)}};h.commit("makeAPICall",n)},updateTitle:function(t){var e={endpoint:"walls/"+this.wall.rid,data:{title:t},method:"put",successCallback:function(t){console.log(t.data)}};h.commit("makeAPICall",e)},connect:function(t){var e=this;console.log(t.members);var n={endpoint:"walls/"+this.wall.rid+"/relations",data:t,method:"post",successCallback:function(t){console.log(t),e.wall.connections.push(t.data),h.commit("forceUserStateUpdate")}};h.commit("makeAPICall",n)},unconnect:function(t){var e=this;console.log(t.members);var n=this.wall.connections.filter(function(e){return-1!=e.members.indexOf(t.members[0])&&-1!=e.members.indexOf(t.members[1])})[0],i={endpoint:"walls/"+this.wall.rid+"/relations/"+n.relation_id,method:"delete",successCallback:function(t){console.log(t);var i=e.wall.connections.indexOf(n);-1!=i&&(e.wall.connections.splice(i,1),h.commit("forceUserStateUpdate"))}};h.commit("makeAPICall",i)},handleScroll:function(){console.log("scroll"),h.commit("setDirtyDraw")}},created:function(){},mounted:function(){},updated:function(){}},M={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Wall"},[n("div",{staticClass:"wallHeader"},[n("drop-down",{attrs:{items:[{label:"Exportera vägg som"},{label:"Versionshistorik"},{label:"Radera vägg",f:t.removeWall}]}},[n("EditableInput",{attrs:{tag:"h2"},on:{change:function(e){return t.updateTitle(e)}},model:{value:t.data.title,callback:function(e){t.$set(t.data,"title",e)},expression:"data.title"}}),t._v(" ▿\n    ")],1)],1),t._v(" "),n("div",{ref:"wallContent",staticClass:"wallContent"},[n("div",{attrs:{id:"collections"}},[n("collections",{attrs:{collections:t.collections,prid:t.wall.prid},on:{createCollection:t.createCollection,removeCollection:t.removeCollection,connect:t.connect,unconnect:t.unconnect}})],1),t._v(" "),n("div",{staticClass:"connections"},t._l(t.connections,function(e){return n("connection",{attrs:{connection:e,dirtyDraw:t.wall.dirtyDraw}})}),1)]),t._v(" "),n("div",{staticClass:"wallFooter"})])},staticRenderFns:[]};var H=n("VU/8")(j,M,!1,function(t){n("cP/A")},"data-v-8ed3d0d0",null).exports,K={name:"Landing",components:{Wall:H},data:function(){return{}},props:{},computed:{walls:function(){return h.state.walls},activeWallId:function(){return h.state.activeWallId}},methods:{},mounted:function(){}},G={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Landing"},[t.walls[t.activeWallId]?n("wall",{attrs:{wall:t.walls[t.activeWallId]}}):t._e(),t._v(" "),n("pre",[t._v("    "+t._s(t.walls[t.activeWallId])+"\n  ")])],1)},staticRenderFns:[]};n("VU/8")(K,G,!1,function(t){n("tuLl")},"data-v-f4734194",null).exports;var q={name:"ViewLogin",components:{KedjaHeader:w},data:function(){return{email:"",pass:""}},props:{},computed:{auth:function(){return h.getters.getAuth}},methods:{login:function(t){h.commit("setAuth",{auth:this.email}),this.$router.push({name:"LoggedIn"})},loggedIn:function(){this.auth&&this.$router.push({name:"LoggedIn"})}},created:function(){this.loggedIn()},mounted:function(){}},z={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewLogin"},[n("kedja-header"),t._v(" "),n("div",{staticClass:"viewContent"},[n("h1",[t._v("\n      KEDJA.\n    ")]),t._v(" "),n("form",{on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{name:"email",type:"email",placeholder:"E-mail...",required:""},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.pass,expression:"pass"}],attrs:{name:"password",type:"password",placeholder:"Lösenord...",required:""},domProps:{value:t.pass},on:{input:function(e){e.target.composing||(t.pass=e.target.value)}}}),t._v(" "),n("button",[t._v("Logga in")])])])],1)},staticRenderFns:[]};var J=n("VU/8")(q,z,!1,function(t){n("Tm4A")},"data-v-36e7e2dc",null).exports,Q={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"RouterLinkBox",style:{"background-color":this.color}},[e("router-link",{staticClass:"link",attrs:{to:this.to}},[this._t("default")],2)],1)},staticRenderFns:[]};var Y={name:"ViewWallList",components:{KedjaHeader:w,RouterLinkBox:n("VU/8")({name:"RouterLinkBox",data:function(){return{}},props:{text:"",color:"",to:""},computed:{},methods:{},mounted:function(){}},Q,!1,function(t){n("dHiP")},"data-v-6c3a7032",null).exports},data:function(){return{walls:""}},props:{},computed:{},methods:{getWalls:function(){var t=this,e={endpoint:"walls",successCallback:function(e){t.walls=e.data}};h.commit("makeAPICall",e)},createWall:function(){var t=this,e={endpoint:"walls",data:{title:"Ny vägg"},method:"post",successCallback:function(e){console.log(e),t.walls.push(e.data)}};h.commit("makeAPICall",e)}},mounted:function(){this.getWalls()}},X={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewWallList"},[n("kedja-header",[n("button",{on:{click:t.createWall}},[t._v("\n      + Ny vägg\n    ")])]),t._v(" "),n("h3",[t._v("Mina väggar")]),t._v(" "),n("div",{staticClass:"wallBoxes"},t._l(t.walls,function(e){return n("router-link-box",{staticClass:"wallBox",attrs:{to:{name:"ViewWall",params:{wallId:e.rid}},color:"lightsteelblue"}},[n("h3",[t._v("\n        "+t._s(e.data.title)+"\n      ")])])}),1),t._v(" "),n("h3",[t._v("Gemensamma väggar")]),t._v(" "),n("div",{staticClass:"wallBoxes"},t._l(t.walls,function(e){return n("router-link-box",{staticClass:"wallBox",attrs:{to:{name:"ViewWall",params:{wallId:e.rid}},color:"lightsteelblue"}},[n("h3",[t._v("\n        "+t._s(e.data.title)+"\n      ")])])}),1)],1)},staticRenderFns:[]};var Z=n("VU/8")(Y,X,!1,function(t){n("coiP")},"data-v-2581ba73",null).exports,tt={name:"ContextMenuCard",components:{CardButton:D},data:function(){return{}},props:{card:""},computed:{collection:function(){return h.getters.getCollectionByCard(this.card)}},methods:{updateTitle:function(t){var e={endpoint:"collections/"+this.collection.rid+"/cards/"+this.card.rid,data:{title:this.card.data.title},method:"put",successCallback:function(t){console.log(t.data)}};h.commit("makeAPICall",e)},removeCard:function(){var t=this,e={endpoint:"collections/"+this.collection.rid+"/cards/"+this.card.rid,method:"delete",successCallback:function(e){console.log(e);var n=t.collection.cards.indexOf(t.card);-1!=n&&t.collection.cards.splice(n,1)}};h.commit("makeAPICall",e)}},mounted:function(){}},et={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ContextMenuCard"},[n("div",{staticClass:"header"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.card.data.title,expression:"card.data.title"}],staticClass:"h2",domProps:{value:t.card.data.title},on:{change:function(e){return t.updateTitle()},input:function(e){e.target.composing||t.$set(t.card.data,"title",e.target.value)}}}),t._v(" "),n("card-button",{nativeOn:{click:function(e){return t.removeCard()}}},[t._v("🗑️")])],1),t._v(" "),n("hr"),t._v(" "),n("h3",[t._v("\n    Beskrivning\n  ")]),t._v(" "),n("p",[t._v("\n    Denna funktion är under utveckling\n  ")]),t._v(" "),n("textarea",{attrs:{placeholder:"Lägg till beskrivning"}}),t._v(" "),n("h3",[t._v("\n    Åtgärder\n  ")]),t._v(" "),n("p",[t._v("\n    Denna funktion är under utveckling\n  ")]),t._v(" "),n("h3",[t._v("Kommentarer")]),t._v(" "),n("p",[t._v("\n    Denna funktion är under utveckling\n  ")])])},staticRenderFns:[]};var nt={name:"ContextMenu",components:{ContextMenuCard:n("VU/8")(tt,et,!1,function(t){n("9gss")},"data-v-8bdf1ede",null).exports},data:function(){return{forceClose:!1}},props:{value:""},computed:{userState:function(){return h.state.userState},card:function(){if("selectCard"==this.userState.name)return h.getters.getCardById(this.userState.data.rid)},hasContent:function(){return this.card}},watch:{hasContent:function(t){this.emitData(t)}},methods:{emitData:function(t){var e=!this.forceClose&&t;this.$emit("input",e)},toggleForceClose:function(){this.forceClose=!this.forceClose}},mounted:function(){}},it={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ContextMenu"},[n("div",{staticClass:"handle",class:{forceClose:t.forceClose},on:{click:function(e){return t.toggleForceClose()}}},[t.hasContent?n("span",[t._v("►")]):n("span",[t._v("◀")])]),t._v(" "),t.card?n("div",[n("ContextMenuCard",{attrs:{card:t.card}})],1):t._e()])},staticRenderFns:[]};var ot={name:"ViewWall",components:{KedjaHeader:w,Wall:H,ContextMenu:n("VU/8")(nt,it,!1,function(t){n("ePcQ")},"data-v-2afcf970",null).exports},data:function(){return{menuOpen:""}},props:{},computed:{wall:function(){return h.getters.getActiveWall()},sidebarFlex:function(){}},methods:{getWallFromParam:function(){var t=this.$route.params.wallId;if(t){var e={endpoint:"walls/"+t,successCallback:function(t){console.log(t),h.commit("setActiveWall",{wall:t.data})}};h.commit("makeAPICall",e)}},createCollection:function(){var t=this,e={endpoint:"walls/"+this.wall.rid+"/collections",data:{title:"Ny samling"},method:"post",successCallback:function(e){console.log(e),t.wall.collections.push(e.data)}};h.commit("makeAPICall",e)}},mounted:function(){this.getWallFromParam()}},at={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewWall"},[n("kedja-header",[n("button",{on:{click:t.createCollection}},[t._v("\n      + Ny samling\n    ")])]),t._v(" "),n("div",{staticClass:"content"},[n("wall",{attrs:{wall:t.wall}}),t._v(" "),n("context-menu",{staticClass:"contextMenu",style:{"flex-basis":t.menuOpen?"300px":"0px"},model:{value:t.menuOpen,callback:function(e){t.menuOpen=e},expression:"menuOpen"}})],1)],1)},staticRenderFns:[]};var ct=n("VU/8")(ot,at,!1,function(t){n("zmV2")},"data-v-0fd45556",null).exports,st={name:"RecursiveAPI",data:function(){return{apiData:""}},props:{},computed:{},methods:{getData:function(){var t=this,e={endpoint:"1657424841601769/wall",successCallback:function(e){t.successCallbackGetWalls(e)}};h.commit("makeAPICall",e)},successCallbackGetWalls:function(t){console.log(t),this.apiData=t}},mounted:function(){this.getData()}},rt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"RecursiveAPI"},[e("pre",[this._v("    "+this._s(this.apiData)+"\n  ")])])},staticRenderFns:[]};var lt=n("VU/8")(st,rt,!1,function(t){n("q/4m")},"data-v-5c9cae8f",null).exports;i.a.use(S.a);var dt=new S.a({mode:"history",routes:[{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:J},{path:"/loggedIn",name:"LoggedIn",redirect:"/walls"},{path:"/walls",name:"ViewWallList",component:Z},{path:"/walls/:wallId",name:"ViewWall",component:ct},{path:"/recursive",name:"RecursiveAPI",component:lt}]});i.a.config.productionTip=!1,new i.a({el:"#app",router:dt,components:{App:I},template:"<App/>"})},OhUg:function(t,e){},Tm4A:function(t,e){},"cP/A":function(t,e){},coiP:function(t,e){},dHiP:function(t,e){},ePcQ:function(t,e){},iymu:function(t,e){},jY9u:function(t,e){},lhjn:function(t,e){t.exports={walls:[{name:"Min vägg",collections:[{name:"Resurser",cards:[{name:"BFL-grupp Kreativ Lärmiljö",id:"0_0"},{name:"Ekonomiska resurser",id:"0_1"},{name:"Avsnitt tid",id:"0_2"},{name:"Elever",id:"0_3"},{name:"Pedagoger",id:"0_4"},{name:"Skolledning",id:"0_5"},{name:"Skolhus",id:"0_6"},{name:"Vaktmästare/lokalansvarig",id:"0_7"}]},{name:"Aktiviteter",cards:[{name:"Samarbete",id:"1_0"},{name:"Inspiration",id:"1_1"},{name:"Elevgrupp",id:"1_2"},{name:"Utformning av klassrumsmiljöer",id:"1_3"},{name:"Utformning av öppna miljöer",id:"1_4"}]},{name:"Resultat",cards:[{name:"Personal",id:"2_0"},{name:"Elever",id:"2_1"},{name:"Pedagogik",id:"2_2"},{name:"Organisation",id:"2_3"}]},{name:"Effekter",cards:[{name:"Kreativ medvetenhet",id:"3_0"},{name:"Kreativa miljöer",id:"3_1"},{name:"Kreativ pedagogik",id:"3_2"}]}],connections:[{id:"0",members:["0_0","1_0"]},{id:"0",members:["0_0","1_2"]},{id:"0",members:["0_0","1_3"]},{id:"0",members:["0_1","1_1"]},{id:"0",members:["0_1","1_2"]},{id:"0",members:["0_1","1_3"]},{id:"0",members:["0_1","1_4"]},{id:"0",members:["0_2","1_0"]},{id:"0",members:["0_2","1_1"]},{id:"0",members:["0_2","1_2"]},{id:"0",members:["0_2","1_3"]},{id:"0",members:["0_3","1_2"]},{id:"0",members:["0_3","1_3"]},{id:"0",members:["0_3","1_4"]},{id:"0",members:["0_4","1_0"]},{id:"0",members:["0_4","1_1"]},{id:"0",members:["0_4","1_2"]},{id:"0",members:["0_4","1_3"]},{id:"0",members:["0_4","1_4"]},{id:"0",members:["0_5","1_0"]},{id:"0",members:["0_5","1_1"]},{id:"0",members:["0_5","1_2"]},{id:"0",members:["0_5","1_3"]},{id:"0",members:["0_5","1_4"]},{id:"0",members:["0_6","1_3"]},{id:"0",members:["0_6","1_4"]},{id:"0",members:["0_7","1_3"]},{id:"0",members:["0_7","1_4"]},{id:"0",members:["1_0","2_0"]},{id:"0",members:["1_0","2_1"]},{id:"0",members:["1_0","2_2"]},{id:"0",members:["1_1","2_0"]},{id:"0",members:["1_1","2_2"]},{id:"0",members:["1_2","2_1"]},{id:"0",members:["1_2","2_2"]},{id:"0",members:["1_3","2_0"]},{id:"0",members:["1_3","2_1"]},{id:"0",members:["1_3","2_2"]},{id:"0",members:["1_3","2_3"]},{id:"0",members:["1_4","2_0"]},{id:"0",members:["1_4","2_1"]},{id:"0",members:["1_4","2_2"]},{id:"0",members:["1_4","2_3"]},{id:"0",members:["2_0","3_0"]},{id:"0",members:["2_0","3_1"]},{id:"0",members:["2_0","3_2"]},{id:"0",members:["2_1","3_0"]},{id:"0",members:["2_1","3_1"]},{id:"0",members:["2_1","3_2"]},{id:"0",members:["2_2","3_0"]},{id:"0",members:["2_2","3_1"]},{id:"0",members:["2_2","3_2"]},{id:"0",members:["2_3","3_0"]},{id:"0",members:["2_3","3_1"]},{id:"0",members:["2_3","3_2"]}]}]}},lvSG:function(t,e){},pUrj:function(t,e){},"q/4m":function(t,e){},tuLl:function(t,e){},"vGR/":function(t,e){},zmV2:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.6ecdd43b871eb1306da2.js.map