webpackJsonp([1],{"/R0z":function(t,e){},"33Lp":function(t,e){},"3xhE":function(t,e){},"51G4":function(t,e){},"6AyU":function(t,e){},DPlu:function(t,e){},DcGM:function(t,e){},F3Rq:function(t,e){},GQsd:function(t,e){},HC44:function(t,e){},HKqJ:function(t,e){},LGMI:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"KedjaLogo"},[e("router-link",{attrs:{to:{name:"Home",params:{}}}},[this._v("\n    KEDJA.\n  ")])],1)},staticRenderFns:[]};var i=n("VU/8")({name:"KedjaLogo",data:function(){return{}},props:{},computed:{},methods:{},mounted:function(){}},o,!1,function(t){n("HC44")},"data-v-528a5eee",null).exports,s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"DropDown"},[t._t("default"),t._v(" "),n("div",{staticClass:"listContainer"},[n("div",{staticClass:"list"},t._l(t.items,function(e){return n("div",{staticClass:"listItem",on:{click:function(n){return t.performFunction(e.f)}}},[t._v("\n        "+t._s(e.label)+"\n      ")])}),0)])],2)},staticRenderFns:[]};var r=n("VU/8")({name:"DropDown",data:function(){return{open:!1}},props:{items:""},computed:{},methods:{toggleList:function(){this.open=!this.open},performFunction:function(t){t&&t()}},mounted:function(){}},s,!1,function(t){n("vGR/")},"data-v-58010b4f",null).exports,c={name:"KedjaHeader",components:{KedjaLogo:i,DropDown:r},data:function(){return{}},props:{},computed:{userData:function(){return this.$store.getters.getUserData}},methods:{goToProfile:function(t){this.$router.push({name:"Profile"})},goToWalls:function(t){this.$router.push({name:"Walls"})},logout:function(t){this.$store.dispatch("logout"),this.$router.push({name:"Login"})}},mounted:function(){}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"KedjaHeader"},[n("kedja-logo"),t._v(" "),n("div",{staticClass:"slot"},[t._t("default")],2),t._v(" "),n("div",{staticClass:"user"},[t.userData.userid?n("div",[n("drop-down",{attrs:{items:[{label:"Min profil",f:t.goToProfile},{label:"Mina vÃ¤ggar",f:t.goToWalls},{label:"Logga ut",f:t.logout}]}},[n("div",{staticClass:"right"},[n("router-link",{attrs:{to:{name:"Profile"}}},[t._v("\n            "+t._s(t.userData.userid)+" "+t._s(t.userData.first_name)+" "+t._s(t.userData.last_name)+"\n          ")])],1)])],1):n("div",[n("router-link",{attrs:{to:{name:"Login"}}},[t._v("Logga in")])],1)])],1)},staticRenderFns:[]};var u=n("VU/8")(c,l,!1,function(t){n("VTxS")},"data-v-15806dab",null).exports,d={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"KedjaHeader"})},staticRenderFns:[]};var m={name:"App",components:{KedjaHeader:u,KedjaFooter:n("VU/8")({name:"KedjaHeader",data:function(){return{}},props:{},computed:{},methods:{},mounted:function(){}},d,!1,function(t){n("/R0z")},"data-v-b2b84a16",null).exports},created:function(){this.$store.commit("init",{})},mounted:function(){document.activeElement.blur()}},f={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view",{attrs:{id:"router"}}),this._v(" "),e("kedja-footer",{attrs:{id:"footer"}})],1)},staticRenderFns:[]};var h=n("VU/8")(m,f,!1,function(t){n("pXLn")},null,null).exports,v=n("/ocq"),g={name:"WrapperComponent",render:function(t){return t(this.tag,this.$slots.default)},props:{tag:{type:String,required:!0}}},p={name:"EditableInput",components:{WrapperComponent:n("VU/8")(g,null,!1,null,null,null).exports},props:{value:String,tag:"",placeholder:{default:"Ange text"},type:{default:"input"}},data:function(){return{editing:!1,textTemp:String,width:"",height:""}},computed:{inputVisible:function(){return this.editing||""==this.value}},watch:{},methods:{openEdit:function(){this.calcWidth(),this.editing=!0,this.textTemp=this.value,this.$nextTick(function(t){this.$refs.input.focus(),this.$refs.input.select()})},finishEdit:function(t){this.editing&&t&&this.emitToParent(),this.editing=!1},calcWidth:function(){this.$nextTick(function(){var t=this.$el.getElementsByClassName("textSpan")[0];t&&(this.width=t.offsetWidth,this.height=t.offsetHeight)})},emitToParent:function(){var t=""!==this.textTemp.trim()?this.textTemp:this.placeholder;this.$emit("input",t),this.$emit("change",t)}}},C={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"EditableInput",class:{fullWidth:t.inputVisible}},[n("wrapper-component",{staticClass:"text",attrs:{tag:t.tag,id:"eiTemp"}},[t.inputVisible?t._e():n("div",{staticClass:"textContainer",on:{click:function(e){return t.openEdit()}}},[n("span",{staticClass:"textSpan"},[t._v("\n        "+t._s(t.value)+"\n      ")])]),t._v(" "),t.inputVisible?n("div",["input"==t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:t.textTemp,expression:"textTemp"}],ref:"input",style:{height:t.height+"px"},attrs:{placeholder:t.placeholder},domProps:{value:t.textTemp},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.finishEdit(!1)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.finishEdit(!0)}],blur:function(e){return t.finishEdit(!0)},input:function(e){e.target.composing||(t.textTemp=e.target.value)}}}):t._e(),t._v(" "),"textarea"==t.type?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textTemp,expression:"textTemp"}],ref:"input",style:{width:t.width+"px",height:t.height+"px"},attrs:{placeholder:t.placeholder},domProps:{value:t.textTemp},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.finishEdit(!1)},blur:function(e){return t.finishEdit(!0)},change:t.calcWidth,input:function(e){e.target.composing||(t.textTemp=e.target.value)}}}):t._e()]):t._e()])],1)},staticRenderFns:[]};var _=n("VU/8")(p,C,!1,function(t){n("3xhE")},"data-v-8b0042fa",null).exports,w={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"CardButton",class:{active:this.active}},[this._t("default")],2)},staticRenderFns:[]};var $=n("VU/8")({name:"CardButton",data:function(){return{}},props:{active:!1},computed:{},methods:{},mounted:function(){}},w,!1,function(t){n("OhUg")},"data-v-5e0839b4",null).exports,k={name:"Card",components:{EditableInput:_,CardButton:$},data:function(){return{hovering:!1}},props:{card:"",prid:""},computed:{userState:function(){return this.$store.getters.getUserState},selected:function(){return"selectCard"==this.userState.name&&this.userState.data.rid==this.card.rid},selectedConnected:function(){return 1==this.card.states.selectedConnected},connections:function(){return this.$store.getters.getDirectConnectionsByCardId(this.card.rid)},connectedCardIds:function(){var t=this,e=[];return this.connections.forEach(function(n,a){n.members[0]!=t.card.rid&&-1==e.indexOf(n.members[0])&&e.push(n.members[0]),n.members[1]!=t.card.rid&&-1==e.indexOf(n.members[1])&&e.push(n.members[1])}),e},connecting:function(){return"connectCard"==this.userState.name&&this.userState.data.rid==this.card.rid},connected:function(){return!1},canConnect:function(){return this.card.states.canConnect}},watch:{userState:{deep:!0,handler:function(t){(this.resetStates(),"selectCard"==t.name&&t.data.rid==this.card.rid&&this.setState("selected",!0),"connectCard"==t.name)&&(t.data.rid==this.card.rid?(this.setState("selected",!0),this.setState("connecting",!0)):-1!=this.connectedCardIds.indexOf(t.data.rid)?this.setState("connected",!0):this.$store.getters.getClosestCardCousins(this.card).find(function(e){return e.rid==t.data.rid})&&this.setState("canConnect",!0))}}},methods:{setState:function(t,e){this.card.states[t]=e},resetStates:function(){this.card.states={}},resetState:function(t){this.card.states[t]=void 0},clicked:function(){"connectCard"!=this.userState.name&&this.setSelected(),this.card.states.connecting&&this.setSelected(),this.card.states.canConnect&&this.connect(),this.card.states.connected&&this.unconnect()},setHovering:function(t){},setSelected:function(t){this.selected?this.$store.commit("resetUserState"):this.$store.commit("setUserState",{name:"selectCard",data:{rid:this.card.rid}})},toggleConnecting:function(t){console.log("connecting "+this.connecting),this.connecting?this.$store.commit("setUserState",{name:"selectCard",data:{rid:this.card.rid}}):this.$store.commit("setUserState",{name:"connectCard",data:{rid:this.card.rid}})},connect:function(){console.log("Connect");var t=this.$store.getters.getCardsByState("connecting")[0];this.$emit("connect",{members:[t.rid,this.card.rid]})},unconnect:function(){console.log("Unconnect");var t=this.$store.getters.getCardsByState("connecting")[0];this.$emit("unconnect",{members:[t.rid,this.card.rid]})},removeCard:function(){this.$emit("removeCard",this.card)},updateTitle:function(t){var e={endpoint:"collections/"+this.prid+"/cards/"+this.card.rid,data:{title:t},method:"put",successCallback:function(t){console.log(t.data)}};this.$store.commit("makeAPICall",e)}},created:function(){this.$store.commit("initCard",this.card)},mounted:function(){}},b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Card",class:{selected:t.card.states.selected,selectedConnectedOther:0==t.card.states.selectedConnected,connected:t.card.states.connected,canConnect:t.card.states.canConnect,cannotConnect:0==t.canConnect&&!t.connecting,connectedOther:0==t.card.states.connected,connecting:t.connecting},on:{mouseenter:function(e){return t.setHovering(!0)},mouseleave:function(e){return t.setHovering(!1)}}},[n("div",{staticClass:"main",on:{"!click":function(e){return t.clicked(e)}}},[n("h3",[t._v("\n      "+t._s(t.card.data.title)+"\n    ")])]),t._v(" "),t.card.states.selected?n("div",{staticClass:"selectedButtons"},[n("card-button",{attrs:{active:t.card.states.connecting},nativeOn:{click:function(e){return t.toggleConnecting(e)}}},[t._v("ðŸ”—")])],1):t._e()])},staticRenderFns:[]};var x={name:"Collection",components:{DropDown:r,Card:n("VU/8")(k,b,!1,function(t){n("SJ6y")},"data-v-240764d1",null).exports,EditableInput:_},data:function(){return{hovering:!1}},computed:{cards:function(){return this.collection.cards},cardsFiltered:function(){return this.cards}},props:{collection:"",prid:""},watch:{},methods:{setHovering:function(t){this.hovering=t},removeCollection:function(){this.$emit("removeCollection",this.collection)},getCardsFromAPI:function(){var t=this,e={endpoint:"collections/"+this.collection.rid+"/cards",successCallback:function(e){t.$store.commit("setCollectionCards",{collection:t.collection,cards:e.data})}};this.$store.commit("makeAPICall",e)},createCard:function(){var t=this,e={endpoint:"collections/"+this.collection.rid+"/cards",data:{title:"Nytt kort"},method:"post",successCallback:function(e){console.log(e),t.cards.push(e.data)}};this.$store.commit("makeAPICall",e)},removeCard:function(t){var e=this,n={endpoint:"collections/"+this.collection.rid+"/cards/"+t.rid,method:"delete",successCallback:function(n){console.log(n);var a=e.collection.cards.indexOf(t);-1!=a&&e.collection.cards.splice(a,1)}};this.$store.commit("makeAPICall",n)},updateTitle:function(t){var e={endpoint:"walls/"+this.prid+"/collections/"+this.collection.rid,data:{title:t},method:"put",successCallback:function(t){console.log(t.data)}};this.$store.commit("makeAPICall",e)},connect:function(t){this.$emit("connect",t)},unconnect:function(t){this.$emit("unconnect",t)},handleScroll:function(){this.$store.commit("setDirtyDraw")}},created:function(){this.$store.commit("initCollection",this.collection)},mounted:function(){this.getCardsFromAPI(),this.$refs.collectionContent.addEventListener("scroll",this.handleScroll)}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Collection",on:{mouseenter:function(e){return t.setHovering(!0)},mouseleave:function(e){return t.setHovering(!1)}}},[n("div",{staticClass:"collectionHeader"},[n("drop-down",{attrs:{items:[{label:"Radera samling",f:t.removeCollection}]}},[n("EditableInput",{attrs:{tag:"h2"},on:{change:function(e){return t.updateTitle(e)}},model:{value:t.collection.data.title,callback:function(e){t.$set(t.collection.data,"title",e)},expression:"collection.data.title"}}),t._v(" â–¿\n    ")],1)],1),t._v(" "),n("div",{ref:"collectionContent",staticClass:"collectionContent"},[n("transition-group",{staticClass:"cards",attrs:{name:"fade",mode:"out-in"}},t._l(t.cards,function(e,a){return n("card",{key:e.rid,attrs:{card:e,id:e.rid,prid:t.collection.rid,tabindex:"0"},on:{removeCard:t.removeCard,connect:t.connect,unconnect:t.unconnect}})}),1)],1),t._v(" "),n("div",{staticClass:"collectionFooter"},[n("button",{staticClass:"fullWidth",attrs:{title:"LÃ¤gg till nytt kort"},on:{click:t.createCard}},[t._v("LÃ¤gg till nytt kort")])])])},staticRenderFns:[]};var D=n("VU/8")(x,y,!1,function(t){n("GQsd")},"data-v-511f7aa4",null).exports,I={name:"Collections",components:{Collection:D},data:function(){return{}},props:{collections:"",prid:""},computed:{},watch:{},methods:{createCollection:function(){this.$emit("createCollection")},removeCollection:function(t){this.$emit("removeCollection",t)},connect:function(t){this.$emit("connect",t)},unconnect:function(t){this.$emit("unconnect",t)},handleScroll:function(){this.$store.commit("setDirtyDraw")}},created:function(){},mounted:function(){this.$refs.collections.addEventListener("scroll",this.handleScroll)}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"collections",staticClass:"Collections"},[t._l(t.collections,function(e){return n("collection",{staticClass:"collection",attrs:{collection:e,prid:t.prid},on:{removeCollection:t.removeCollection,connect:t.connect,unconnect:t.unconnect}})}),t._v(" "),n("button",{staticClass:"new",attrs:{title:"LÃ¤gg till ny samling"},on:{click:t.createCollection}},[t._v("+ Ny samling")])],2)},staticRenderFns:[]};var S={name:"Connection",data:function(){return{loaded:!1,x0:"",y0:"",x1:"",y1:""}},props:{connection:"",dirtyDraw:!1},computed:{yMin:function(){return this.$store.state.connectionBounds.y},yMax:function(){return this.$store.state.connectionBounds.y+this.$store.state.connectionBounds.height},height:function(){return this.yMax-this.yMin},from:function(){return this.connection.members[0]},to:function(){return this.connection.members[1]},width:function(){return Math.abs(this.x1-this.x0)},left:function(){return Math.min(this.x0,this.x1)},top:function(){return Math.min(this.y0,this.y1)}},watch:{dirtyDraw:function(t){t&&this.redraw()}},methods:{firstDraw:function(){var t=document.getElementById(this.from),e=document.getElementById(this.to);t&&e?this.$store.commit("setDirtyDraw"):setTimeout(this.firstDraw,100)},redraw:function(){this.setBounds(),this.drawCanvas()},setBounds:function(){if(document.getElementById(this.from)&&document.getElementById(this.to)){var t=document.getElementById(this.from),e=document.getElementById(this.to),n=void 0,a=void 0;t.getBoundingClientRect().x<e.getBoundingClientRect().x?(n=t,a=e):(n=e,a=t),this.x0=n.getBoundingClientRect().x+n.getBoundingClientRect().width,this.y0=n.getBoundingClientRect().y-this.yMin+n.getBoundingClientRect().height/2,this.x1=a.getBoundingClientRect().x,this.y1=a.getBoundingClientRect().y-this.yMin+a.getBoundingClientRect().height/2}},drawCanvas:function(){var t=this.$el.getElementsByTagName("canvas")[0],e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),e.lineWidth=6,e.strokeStyle="#ffffff",e.beginPath();var n=this.y0,a=this.y1;e.moveTo(0,n),e.lineTo(this.width/2,n),e.lineTo(this.width/2,a),e.lineTo(this.width,a),e.stroke(),e.lineWidth=3}},created:function(){this.$store.commit("initConnection",this.connection)},mounted:function(){this.firstDraw()},updated:function(){this.redraw()}},W={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"Connection z0",style:{top:this.yMin+"px",left:this.left+"px"}},[e("canvas",{staticClass:"canvasConnection",attrs:{width:this.width,height:this.height}})])},staticRenderFns:[]};var A={name:"Wall",components:{KedjaHeader:u,DropDown:r,Collections:n("VU/8")(I,E,!1,function(t){n("NpaA")},"data-v-3adf36b4",null).exports,Collection:D,Connection:n("VU/8")(S,W,!1,function(t){n("51G4")},"data-v-7918a5f6",null).exports,EditableInput:_},data:function(){return{}},props:{wall:""},computed:{userState:function(){return this.$store.getters.getUserState},data:function(){return this.wall.data},collections:function(){return this.wall.collections},connections:function(){return this.wall.connections}},watch:{wall:function(){this.$store.commit("initWall",this.wall),this.getCollectionsFromAPI(),this.getConnectionsFromAPI()},collections:function(){}},methods:{getCollectionsFromAPI:function(){var t=this,e=this.$route.params.wallId;if(e){var n={endpoint:"walls/"+e+"/collections",successCallback:function(e){t.$store.commit("setWallCollections",{wall:t.wall,collections:e.data})}};this.$store.commit("makeAPICall",n)}},getConnectionsFromAPI:function(){var t=this,e=this.$route.params.wallId;if(e){var n={endpoint:"walls/"+e+"/relations",successCallback:function(e){t.$store.commit("setWallConnections",{wall:t.wall,connections:e.data})}};this.$store.commit("makeAPICall",n)}},getWallLocal:function(){this.wall=this.$store.getters.getActiveWall()},createCollection:function(){var t=this,e={endpoint:"walls/"+this.wall.rid+"/collections",data:{title:"Ny samling"},method:"post",successCallback:function(e){t.collections.push(e.data)}};this.$store.commit("makeAPICall",e)},removeWall:function(){var t=this,e={endpoint:"walls/"+this.wall.rid,method:"delete",successCallback:function(e){t.$router.push({name:"ViewWallList"})}};this.$store.commit("makeAPICall",e)},removeCollection:function(t){var e=this,n={endpoint:"walls/"+this.wall.rid+"/collections/"+t.rid,method:"delete",successCallback:function(n){console.log(n);var a=e.wall.collections.indexOf(t);-1!=a&&e.wall.collections.splice(a,1)}};this.$store.commit("makeAPICall",n)},updateTitle:function(t){var e={endpoint:"walls/"+this.wall.rid,data:{title:t},method:"put",successCallback:function(t){}};this.$store.commit("makeAPICall",e)},connect:function(t){var e=this;console.log(t.members);var n={endpoint:"walls/"+this.wall.rid+"/relations",data:t,method:"post",successCallback:function(t){console.log(t),e.wall.connections.push(t.data),e.$store.commit("forceUserStateUpdate")}};this.$store.commit("makeAPICall",n)},unconnect:function(t){var e=this;console.log(t.members);var n=this.wall.connections.filter(function(e){return-1!=e.members.indexOf(t.members[0])&&-1!=e.members.indexOf(t.members[1])})[0],a={endpoint:"walls/"+this.wall.rid+"/relations/"+n.relation_id,method:"delete",successCallback:function(t){console.log(t);var a=e.wall.connections.indexOf(n);-1!=a&&(e.wall.connections.splice(a,1),e.$store.commit("forceUserStateUpdate"))}};this.$store.commit("makeAPICall",a)},handleScroll:function(){console.log("scroll"),this.$store.commit("setDirtyDraw")}},created:function(){},mounted:function(){},updated:function(){}},U={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Wall"},[n("div",{staticClass:"wallHeader"},[n("drop-down",{attrs:{items:[{label:"Radera vÃ¤gg",f:t.removeWall}]}},[n("EditableInput",{attrs:{tag:"h2"},on:{change:function(e){return t.updateTitle(e)}},model:{value:t.data.title,callback:function(e){t.$set(t.data,"title",e)},expression:"data.title"}}),t._v(" â–¿\n    ")],1)],1),t._v(" "),n("div",{ref:"wallContent",staticClass:"wallContent"},[n("div",{attrs:{id:"collections"}},[n("collections",{attrs:{collections:t.collections,prid:t.wall.prid},on:{createCollection:t.createCollection,removeCollection:t.removeCollection,connect:t.connect,unconnect:t.unconnect}})],1),t._v(" "),n("div",{staticClass:"connections"},t._l(t.connections,function(e){return n("connection",{attrs:{connection:e,dirtyDraw:t.wall.dirtyDraw}})}),1)]),t._v(" "),n("div",{staticClass:"wallFooter"})])},staticRenderFns:[]};var P=n("VU/8")(A,U,!1,function(t){n("DPlu")},"data-v-cfe9bc2a",null).exports,B={name:"Landing",components:{Wall:P},data:function(){return{}},props:{},computed:{walls:function(){return this.$store.state.walls},activeWallId:function(){return this.$store.state.activeWallId}},methods:{},mounted:function(){}},R={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Landing"},[t.walls[t.activeWallId]?n("wall",{attrs:{wall:t.walls[t.activeWallId]}}):t._e(),t._v(" "),n("pre",[t._v("    "+t._s(t.walls[t.activeWallId])+"\n  ")])],1)},staticRenderFns:[]};n("VU/8")(B,R,!1,function(t){n("Zckc")},"data-v-2e35e0aa",null).exports;var F={name:"ViewHome",components:{KedjaHeader:u},data:function(){return{}},props:{},computed:{userData:function(){return this.$store.getters.getUserData}},methods:{loggedIn:function(){this.userData.userid?this.$router.push({name:"Walls"}):this.$router.push({name:"Login"})}},created:function(){this.loggedIn()},mounted:function(){}},V={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ViewHome"},[e("kedja-header"),this._v(" "),e("div",{staticClass:"viewContent"},[this._v("\n    HEM\n  ")])],1)},staticRenderFns:[]};var L=n("VU/8")(F,V,!1,function(t){n("6AyU")},"data-v-6f280701",null).exports,T={name:"ViewLogin",components:{KedjaHeader:u},data:function(){return{email:"",pass:"",methods:""}},props:{},computed:{userData:function(){return this.$store.getters.getUserData}},methods:{getLoginMethods:function(){var t=this,e={endpoint:"auth/methods",successCallback:function(e){t.methods=e.data}};this.$store.commit("makeAPICall",e)},loggedIn:function(){this.userData.userid&&this.$router.push({name:"Home"})}},created:function(){this.loggedIn()},mounted:function(){this.getLoginMethods()}},H={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewLogin"},[n("kedja-header"),t._v(" "),n("div",{staticClass:"viewContent"},[n("h1",[t._v("\n      KEDJA.\n    ")]),t._v(" "),n("h3",[t._v("Logga in / Registrera nytt konto med")]),t._v(" "),t._l(t.methods,function(e){return n("h2",[n("a",{attrs:{href:e.url}},[t._v(t._s(e.title))])])})],2)],1)},staticRenderFns:[]};var M=n("VU/8")(T,H,!1,function(t){n("kMRc")},"data-v-d8cd4fc0",null).exports,j={name:"ViewRegister",components:{KedjaHeader:u},data:function(){return{}},props:{},computed:{auth:function(){return this.$store.getters.getAuth},userid:function(){return this.$route.query.u},token:function(){return this.$route.query.t}},methods:{login:function(){var t=this,e={endpoint:"auth/credentials/"+this.userid+"/"+this.token,method:"post",successCallback:function(e){t.$store.dispatch("setUserData",{field:"auth",value:e.data.Authorization}),t.$store.dispatch("setUserData",{field:"userid",value:e.data.userid}),t.$router.push({name:"Home"})}};this.$store.commit("makeAPICall",e)}},created:function(){},mounted:function(){this.login()}},O={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ViewRegister"},[e("kedja-header"),this._v(" "),e("div",{staticClass:"viewContent"},[this._v("\n    Du loggas in.\n  ")])],1)},staticRenderFns:[]};var K=n("VU/8")(j,O,!1,function(t){n("qYLt")},"data-v-7ccd0cf8",null).exports,N={name:"ViewRegister",components:{KedjaHeader:u},data:function(){return{}},props:{},computed:{registerToken:function(){return this.$route.query.t}},methods:{register:function(){var t=this,e={endpoint:"auth/register/"+this.registerToken,method:"post",successCallback:function(e){t.$store.dispatch("setUserData",{field:"auth",value:e.data.Authorization}),t.$store.dispatch("setUserData",{field:"userid",value:e.data.userid})}};this.$store.commit("makeAPICall",e)}},created:function(){},mounted:function(){}},q={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewRegister"},[n("kedja-header"),t._v(" "),n("div",{staticClass:"viewContent"},[n("h2",[t._v("Registrera nytt konto")]),t._v(" "),n("p",[t._v("\n      Du behÃ¶ver registrera ett konto pÃ¥ Kedja fÃ¶r att fortsÃ¤tta inloggningen.\n    ")]),t._v(" "),t._m(0),t._v(" "),n("form",{on:{submit:function(e){return e.preventDefault(),t.register(e)}}},[t._m(1),t._v(" "),n("button",{attrs:{type:"submit"}},[t._v("SÃ¤lj min sjÃ¤l")])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("a",{attrs:{href:""}},[this._v("LÃ¤s anvÃ¤ndaravtal")]),this._v(" fÃ¶r registrering och anvÃ¤ndning av Kedja.\n    ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",[e("input",{attrs:{type:"checkbox"}}),this._v(" Jag gÃ¥r med pÃ¥ allt.\n      ")])}]};var G=n("VU/8")(N,q,!1,function(t){n("bPE7")},"data-v-40c2e328",null).exports,J=n("woOf"),z=n.n(J),Y={name:"ViewProfile",components:{KedjaHeader:u},data:function(){return{userDataEditable:""}},props:{},computed:{userData:function(){return this.$store.getters.getUserData}},methods:{getUserProfile:function(){var t=this,e={endpoint:"users/"+this.userData.userid,successCallback:function(e){t.userProfile=e.data}};this.$store.commit("makeAPICall",e)},updateProfile:function(){var t=this,e={endpoint:"users/"+this.userData.userid,method:"put",data:{first_name:this.userDataEditable.first_name,last_name:this.userDataEditable.last_name},successCallback:function(e){t.$store.dispatch("setUserData",{field:"first_name",value:e.data.data.first_name}),t.$store.dispatch("setUserData",{field:"last_name",value:e.data.data.last_name})}};this.$store.commit("makeAPICall",e)}},created:function(){this.userDataEditable=z()({},this.userData)},mounted:function(){this.getUserProfile()}},Q={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewProfile"},[n("kedja-header"),t._v(" "),n("div",{staticClass:"viewContent"},[t._v("\n    Du Ã¤r inloggad som\n\n    "),n("h2",[t._v("\n      "+t._s(t.userData.userid)+" "+t._s(t.userData.first_name)+" "+t._s(t.userData.last_name)+"\n    ")]),t._v(" "),n("h3",[t._v("Uppdatera profil")]),t._v(" "),n("form",{on:{submit:function(e){return e.preventDefault(),t.updateProfile(e)}}},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.userDataEditable.first_name,expression:"userDataEditable.first_name"}],attrs:{type:"text",placeholder:"FÃ¶rnamn"},domProps:{value:t.userDataEditable.first_name},on:{input:function(e){e.target.composing||t.$set(t.userDataEditable,"first_name",e.target.value)}}})]),t._v(" "),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.userDataEditable.last_name,expression:"userDataEditable.last_name"}],attrs:{type:"text",placeholder:"Efternamn"},domProps:{value:t.userDataEditable.last_name},on:{input:function(e){e.target.composing||t.$set(t.userDataEditable,"last_name",e.target.value)}}})]),t._v(" "),n("button",{attrs:{type:"submit"}},[t._v("Spara Ã¤ndringar")])])])],1)},staticRenderFns:[]};var X=n("VU/8")(Y,Q,!1,function(t){n("F3Rq")},"data-v-27691832",null).exports,Z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"RouterLinkBox",style:{"background-color":this.color}},[e("router-link",{staticClass:"link",attrs:{to:this.to}},[this._t("default")],2)],1)},staticRenderFns:[]};var tt={name:"ViewWallList",components:{KedjaHeader:u,RouterLinkBox:n("VU/8")({name:"RouterLinkBox",data:function(){return{}},props:{text:"",color:"",to:""},computed:{},methods:{},mounted:function(){}},Z,!1,function(t){n("dHiP")},"data-v-6c3a7032",null).exports},data:function(){return{}},props:{},computed:{walls:function(){return this.$store.getters["walls/all"]}},methods:{getWalls:function(){var t=this,e={endpoint:"walls",successCallback:function(e){t.walls=e.data}};this.$store.commit("makeAPICall",e)},getWallsStore:function(){this.$store.dispatch("walls/getWalls")},createWall:function(){var t=this,e={endpoint:"walls",data:{title:"Ny vÃ¤gg"},method:"post",successCallback:function(e){console.log(e),t.walls.push(e.data)},errorCallback:function(t){console.log("Du Ã¤r inte inloggad. Logga in fÃ¶r att fortsÃ¤tta."),console.log(t)}};this.$store.commit("makeAPICall",e)}},created:function(){},mounted:function(){this.getWallsStore()}},et={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewWallList"},[n("kedja-header",[n("button",{on:{click:t.createWall}},[t._v("\n      + Ny vÃ¤gg\n    ")])]),t._v(" "),n("h3",[t._v("Mina vÃ¤ggar")]),t._v(" "),n("div",{staticClass:"wallBoxes"},t._l(t.walls,function(e){return n("router-link-box",{staticClass:"wallBox",attrs:{to:{name:"ViewWall",params:{wallId:e.rid}},color:"lightsteelblue"}},[n("h3",[t._v("\n        "+t._s(e.data.title)+"\n      ")])])}),1),t._v(" "),n("h3",[t._v("Gemensamma vÃ¤ggar")]),t._v(" "),n("div",{staticClass:"wallBoxes"},t._l(t.walls,function(e){return n("router-link-box",{staticClass:"wallBox",attrs:{to:{name:"ViewWall",params:{wallId:e.rid}},color:"lightsteelblue"}},[n("h3",[t._v("\n        "+t._s(e.data.title)+"\n      ")])])}),1)],1)},staticRenderFns:[]};var nt=n("VU/8")(tt,et,!1,function(t){n("LGMI")},"data-v-58d8d82e",null).exports,at={name:"ContextMenuCard",components:{CardButton:$},data:function(){return{}},props:{card:""},computed:{collection:function(){return this.$store.getters.getCollectionByCard(this.card)}},methods:{updateTitle:function(t){var e={endpoint:"collections/"+this.collection.rid+"/cards/"+this.card.rid,data:{title:this.card.data.title},method:"put",successCallback:function(t){console.log(t.data)}};this.$store.commit("makeAPICall",e)},removeCard:function(){var t=this,e={endpoint:"collections/"+this.collection.rid+"/cards/"+this.card.rid,method:"delete",successCallback:function(e){console.log(e);var n=t.collection.cards.indexOf(t.card);-1!=n&&t.collection.cards.splice(n,1)}};this.$store.commit("makeAPICall",e)}},mounted:function(){}},ot={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ContextMenuCard"},[n("div",{staticClass:"header"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.card.data.title,expression:"card.data.title"}],staticClass:"h2",domProps:{value:t.card.data.title},on:{change:function(e){return t.updateTitle()},input:function(e){e.target.composing||t.$set(t.card.data,"title",e.target.value)}}}),t._v(" "),n("card-button",{nativeOn:{click:function(e){return t.removeCard()}}},[t._v("ðŸ—‘ï¸")])],1),t._v(" "),n("hr"),t._v(" "),n("h3",[t._v("\n    Beskrivning\n  ")]),t._v(" "),n("p",[t._v("\n    Denna funktion Ã¤r under utveckling\n  ")]),t._v(" "),n("textarea",{attrs:{placeholder:"LÃ¤gg till beskrivning"}}),t._v(" "),n("h3",[t._v("\n    Ã…tgÃ¤rder\n  ")]),t._v(" "),n("p",[t._v("\n    Denna funktion Ã¤r under utveckling\n  ")]),t._v(" "),n("h3",[t._v("Kommentarer")]),t._v(" "),n("p",[t._v("\n    Denna funktion Ã¤r under utveckling\n  ")])])},staticRenderFns:[]};var it={name:"ContextMenu",components:{ContextMenuCard:n("VU/8")(at,ot,!1,function(t){n("DcGM")},"data-v-2586b634",null).exports},data:function(){return{forceClose:!1}},props:{value:""},computed:{userState:function(){return this.$store.state.userState},card:function(){if("selectCard"==this.userState.name)return this.$store.getters.getCardById(this.userState.data.rid)},hasContent:function(){return this.card}},watch:{hasContent:function(t){this.emitData(t)}},methods:{emitData:function(t){var e=!this.forceClose&&t;this.$emit("input",e)},toggleForceClose:function(){this.forceClose=!this.forceClose}},mounted:function(){}},st={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ContextMenu"},[n("div",{staticClass:"handle",class:{forceClose:t.forceClose},on:{click:function(e){return t.toggleForceClose()}}},[t.hasContent?n("span",[t._v("â–º")]):n("span",[t._v("â—€")])]),t._v(" "),t.card?n("div",[n("ContextMenuCard",{attrs:{card:t.card}})],1):t._e()])},staticRenderFns:[]};var rt={name:"ViewWall",components:{KedjaHeader:u,Wall:P,ContextMenu:n("VU/8")(it,st,!1,function(t){n("HKqJ")},"data-v-5e62b33f",null).exports},data:function(){return{menuOpen:""}},props:{},computed:{wall:function(){return this.$store.getters.getActiveWall()},sidebarFlex:function(){}},methods:{getWallFromParam:function(){var t=this,e=this.$route.params.wallId;if(e){var n={endpoint:"walls/"+e,successCallback:function(e){t.$store.commit("setActiveWall",{wall:e.data})}};this.$store.commit("makeAPICall",n)}},createCollection:function(){var t=this,e={endpoint:"walls/"+this.wall.rid+"/collections",data:{title:"Ny samling"},method:"post",successCallback:function(e){console.log(e),t.wall.collections.push(e.data)}};this.$store.commit("makeAPICall",e)}},mounted:function(){this.getWallFromParam()}},ct={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ViewWall"},[n("kedja-header",[n("button",{on:{click:t.createCollection}},[t._v("\n      + Ny samling\n    ")])]),t._v(" "),n("div",{staticClass:"content"},[n("wall",{attrs:{wall:t.wall}}),t._v(" "),n("context-menu",{staticClass:"contextMenu",style:{"flex-basis":t.menuOpen?"300px":"0px"},model:{value:t.menuOpen,callback:function(e){t.menuOpen=e},expression:"menuOpen"}})],1)],1)},staticRenderFns:[]};var lt=n("VU/8")(rt,ct,!1,function(t){n("33Lp")},"data-v-279ba79c",null).exports;a.a.use(v.a);var ut=new v.a({mode:"history",routes:[{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:M},{path:"/logging_in",name:"LoggingIn",component:K},{path:"/register",name:"Register",component:G},{path:"/home",name:"Home",component:L},{path:"/profile",name:"Profile",component:X},{path:"/walls",name:"Walls",component:nt},{path:"/walls/:wallId",name:"ViewWall",component:lt}]}),dt=n("lHA8"),mt=n.n(dt),ft=n("Gu7T"),ht=n.n(ft),vt=n("2aIq"),gt=n.n(vt),pt=n("NYxO"),Ct=n("mtWM"),_t=n.n(Ct),wt={namespaced:!0,modules:{collections:{namespaced:!0,modules:{cards:{namespaced:!0,modules:{},state:{},getters:{},actions:{},mutations:{}}},state:{},getters:{},actions:{},mutations:{}}},state:{walls:""},getters:{all:function(t){return t.walls}},actions:{getWalls:function(t){t.dispatch("makeAPICall",{endpoint:"walls"},{root:!0}).then(function(e){t.commit("setWalls",e)},function(t){console.log(t)}).catch(function(t){console.log(t)})}},mutations:{setWalls:function(t,e){t.walls=e.data}}};a.a.use(pt.a);var $t=new pt.a.Store({modules:{walls:wt},state:{walls:[],activeWallId:0,activeWall:"",connections:[],tabIndexCounter:0,connectionBounds:"",userState:"",auth:"",userid:"",userData:{}},mutations:{init:function(t,e){gt()(e),$t.commit("setUserDataFromLocalStorage")},setUserDataFromLocalStorage:function(t){"undefined"!=typeof Storage?(a.a.set(t.userData,"auth",localStorage.getItem("auth")),a.a.set(t.userData,"userid",localStorage.getItem("userid")),a.a.set(t.userData,"first_name",localStorage.getItem("first_name")),a.a.set(t.userData,"last_name",localStorage.getItem("last_name"))):console.log("No local storage support")},resetUserState:function(t){$t.commit("setUserState",{name:"default"})},setUserState:function(t,e){var n=e.name,a=e.data;$t.commit("setDirtyDraw"),t.userState={name:n,data:a||{},rand:Math.random()}},forceUserStateUpdate:function(t){$t.commit("setDirtyDraw"),t.userState.rand=Math.random()},setActiveWall:function(t,e){var n=e.wall;t.activeWall=n},setWallCollections:function(t,e){var n=e.wall,o=e.collections;a.a.set(n,"collections",o)},setWallConnections:function(t,e){var n=e.wall,o=e.connections;a.a.set(n,"connections",o)},setCollectionCards:function(t,e){var n=e.collection,o=e.cards;a.a.set(n,"cards",o)},setConnections:function(t,e){var n=e.connections;t.connections=n},initWall:function(t,e){a.a.set(e,"collections",[]),a.a.set(e,"connections",[]),a.a.set(e,"dirtyDraw",!1)},initCollection:function(t,e){a.a.set(e,"cards",[])},initCard:function(t,e){a.a.set(e,"states",{})},initConnection:function(t,e){a.a.set(e,"dirtyDraw",!1)},setDirtyDraw:function(t){var e=$t.getters.getActiveWall();a.a.set(e,"dirtyDraw",!0),t.connectionBounds=document.getElementsByClassName("collectionContent")[0].getBoundingClientRect(),a.a.nextTick().then(function(){a.a.set(e,"dirtyDraw",!1)})},setDeepConnectionsByCardId:function(t,e){var n=e.id;console.log("Set deep connections"),t.connections=$t.getters.getDeepConnectionsByCardId(n)},resetConnections:function(t){console.log("Reset connections"),t.connections=[],console.log(t.connections.length)},setCanConnectByCardId:function(t,e){var n=e.id,a=$t.getters.getCollectionByCardId(n);console.log(a);var o=$t.getters.getActiveWall(),i=$t.getters.getClosestArraySiblings(o.collections,a);console.log(i),i.forEach(function(t,e){t&&t.cards.forEach(function(t,e){$t.commit("setCardState",{card:t,stateName:"connectingCanConnect",stateFlag:!0})})})},makeAPICall:function(t,e){var n=e.method?e.method:"get",a=e.errorCallback?e.errorCallback:function(t){console.log(t)};_t()({method:n,url:"https://staging-server.kedja.org/api/1/"+e.endpoint,headers:{Authorization:$t.getters.getUserData.auth},params:e.params,data:e.data}).then(e.successCallback,a).catch(function(t){console.log(t)})},errorCallback:function(t,e){console.log("Error"),console.log(e)}},actions:{setUserData:function(t,e){var n=e.field,a=e.value;"undefined"!=typeof Storage?localStorage.setItem(n,a):console.log("No local storage support"),t.commit("setUserDataFromLocalStorage")},logout:function(t){"undefined"!=typeof Storage?(localStorage.removeItem("auth"),localStorage.removeItem("userid"),localStorage.removeItem("first_name"),localStorage.removeItem("last_name")):console.log("No local storage support"),t.commit("setUserDataFromLocalStorage")},checkAuth:function(t){t.getters.getAuth},makeAPICall:function(t,e){var n=e.method?e.method:"get";return _t()({method:n,url:"https://staging-server.kedja.org/api/1/"+e.endpoint,headers:{Authorization:$t.getters.getAuth},params:e.params,data:e.data})}},getters:{getUserData:function(t){return t.userData},getUserState:function(t){return t.userState},getActiveWall:function(t){return function(){return t.activeWall}},getCardById:function(t){return function(t){var e=void 0;return $t.getters.getActiveWall().collections.forEach(function(n,a){var o=n.cards.find(function(e){return e.rid==t});o&&(e=o)}),e}},getCardsByIds:function(t){return function(t){var e=[];return $t.getters.getActiveWall().collections.forEach(function(n,a){e=e.concat(n.cards.filter(function(e){return-1!=t.indexOf(e.rid)}))}),e}},getCardsByIdsInverted:function(t){return function(t){var e=[];return $t.getters.getActiveWall().collections.forEach(function(n,a){e=e.concat(n.cards.filter(function(e){return-1==t.indexOf(e.rid)}))}),e}},getCardsInverted:function(t){return function(t){var e=[];return $t.getters.getActiveWall().collections.forEach(function(n,a){e=e.concat(n.cards.filter(function(e){return-1==t.indexOf(e)}))}),e}},getClosestCardCousins:function(t){return function(t){var e=$t.getters.getCollectionByCard(t),n=$t.getters.getActiveWall(),a=[];return $t.getters.getClosestArraySiblings(n.collections,e).forEach(function(t,e){t&&(a=a.concat(t.cards))}),a}},getCollectionByCard:function(t){return function(t){return $t.getters.getActiveWall().collections.find(function(e){return-1!=e.cards.indexOf(t)})}},getCardsByState:function(t){return function(t){var e=[];return $t.getters.getActiveWall().collections.forEach(function(n,a){e=e.concat(n.cards.filter(function(e){return e.states[t]}))}),e}},getDirectConnectionsByCardId:function(t){return function(t){var e=$t.getters.getActiveWall();return e.connections?e.connections.filter(function(e){return-1!=e.members.indexOf(t)}):[]}},getDeepConnectionsByCardId:function(t){return function(t){var e=$t.getters.getActiveWall().connections,n=$t.getters.getRecursiveConnectionsByCardId(e,t,!0);return n=n.concat($t.getters.getRecursiveConnectionsByCardId(e,t,!1)),n=[].concat(ht()(new mt.a(n)))}},getRecursiveConnectionsByCardId:function(t){return function(t,e,n){if(!t)return[];var a=t.filter(function(t){return t.members[+!n]==e}),o=[];return a.forEach(function(e,a){o=o.concat($t.getters.getRecursiveConnectionsByCardId(t,e.members[+n],n))}),a=a.concat(o)}},getClosestArraySiblings:function(t){return function(t,e){if(!t)return[];var n=[void 0,void 0],a=t.indexOf(e);return a>0&&(n[0]=t[a-1]),a<t.length-1&&(n[1]=t[a+1]),n}},getTreeById:function(t){return function(t){}},getWalls:function(t){return function(){return t.walls}}}});a.a.config.productionTip=!1,new a.a({el:"#app",router:ut,store:$t,components:{App:h},template:"<App/>"})},NpaA:function(t,e){},OhUg:function(t,e){},SJ6y:function(t,e){},VTxS:function(t,e){},Zckc:function(t,e){},bPE7:function(t,e){},dHiP:function(t,e){},kMRc:function(t,e){},pXLn:function(t,e){},qYLt:function(t,e){},"vGR/":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.38dd9fb06cc8fc708b7b.js.map